"use strict";(()=>{var e={};e.id=23,e.ids=[23],e.modules={53524:e=>{e.exports=require("@prisma/client")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},12177:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>b,originalPathname:()=>w,patchFetch:()=>k,requestAsyncStorage:()=>g,routeModule:()=>h,serverHooks:()=>f,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>v});var n={};r.r(n),r.d(n,{GET:()=>d,POST:()=>l,runtime:()=>p});var s=r(22534),a=r(79409),o=r(36717),i=r(27445),u=r(6113),c=r.n(u);let p="nodejs";async function d(e){let t=e.nextUrl.searchParams,r=t.get("hub.mode"),n=t.get("hub.verify_token"),s=t.get("hub.challenge"),a=process.env.FB_MESSENGER_VERIFY_TOKEN;return"subscribe"===r&&n===a?(console.log("Messenger Webhook verified"),new i.Z(s,{status:200})):new i.Z("Forbidden",{status:403})}async function l(e){let t=e.headers.get("x-hub-signature-256"),n=await e.text(),s=process.env.FB_APP_SECRET,a=!1;try{a=function(e,t,r){if(!t)return!1;let n="sha256="+c().createHmac("sha256",r).update(e).digest("hex");return c().timingSafeEqual(Buffer.from(t),Buffer.from(n))}(n,t||"",s)}catch(e){a=!1}if(!a)return console.warn("Invalid Signature on Webhook"),new i.Z("Invalid Signature",{status:401});let o={};try{o=JSON.parse(n)}catch(e){return new i.Z("Invalid JSON",{status:400})}try{let{processMessengerEvent:e}=await r.e(969).then(r.bind(r,81969));await e(o)}catch(e){console.error("Processing failed",e)}return i.Z.json({ok:!0})}let h=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/webhooks/messenger/route",pathname:"/api/webhooks/messenger",filename:"route",bundlePath:"app/api/webhooks/messenger/route"},resolvedPagePath:"C:\\Users\\jeang\\OneDrive\\Desktop\\adnext\\apps\\web\\src\\app\\api\\webhooks\\messenger\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:g,staticGenerationAsyncStorage:m,serverHooks:f,headerHooks:b,staticGenerationBailout:v}=h,w="/api/webhooks/messenger/route";function k(){return(0,o.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:m})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[150,363],()=>r(12177));module.exports=n})();