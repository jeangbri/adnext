(()=>{var e={};e.id=2367,e.ids=[2367],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},90291:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>l,routeModule:()=>f,tree:()=>c});var a=r(28090),s=r(79409),n=r(31522),i=r.n(n),o=r(41305),d={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>o[e]);r.d(t,d);let c=["",{children:["(dashboard)",{children:["broadcast",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,46144)),"C:\\Users\\jeang\\OneDrive\\Desktop\\adnext\\apps\\web\\src\\app\\(dashboard)\\broadcast\\[id]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,63470)),"C:\\Users\\jeang\\OneDrive\\Desktop\\adnext\\apps\\web\\src\\app\\(dashboard)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,70111,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,13840)),"C:\\Users\\jeang\\OneDrive\\Desktop\\adnext\\apps\\web\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,70111,23)),"next/dist/client/components/not-found-error"]}],l=["C:\\Users\\jeang\\OneDrive\\Desktop\\adnext\\apps\\web\\src\\app\\(dashboard)\\broadcast\\[id]\\page.tsx"],u="/(dashboard)/broadcast/[id]/page",p={require:r,loadChunk:()=>Promise.resolve()},f=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/(dashboard)/broadcast/[id]/page",pathname:"/broadcast/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},57409:(e,t,r)=>{let a={"67ec2a3b5879da03fd9db50f251cecdfe825c359":()=>Promise.resolve().then(r.bind(r,56087)).then(e=>e.deleteProject),"7a8a07ed673e87719a224ba5bdd94c5abf5790df":()=>Promise.resolve().then(r.bind(r,56087)).then(e=>e.createProject),"7d8e4dd9996424d0e268f2b3af549e67be85e477":()=>Promise.resolve().then(r.bind(r,56087)).then(e=>e.updatePageProject),f8668bd5f71af427a636b6031eb02965154b8feb:()=>Promise.resolve().then(r.bind(r,56087)).then(e=>e.getProjects),"6511aec7141895e8bedebb549690cdc948a691f5":()=>Promise.resolve().then(r.bind(r,80736)).then(e=>e.setContext)};async function s(e,...t){return(await a[e]()).apply(null,t)}e.exports={"67ec2a3b5879da03fd9db50f251cecdfe825c359":s.bind(null,"67ec2a3b5879da03fd9db50f251cecdfe825c359"),"7a8a07ed673e87719a224ba5bdd94c5abf5790df":s.bind(null,"7a8a07ed673e87719a224ba5bdd94c5abf5790df"),"7d8e4dd9996424d0e268f2b3af549e67be85e477":s.bind(null,"7d8e4dd9996424d0e268f2b3af549e67be85e477"),f8668bd5f71af427a636b6031eb02965154b8feb:s.bind(null,"f8668bd5f71af427a636b6031eb02965154b8feb"),"6511aec7141895e8bedebb549690cdc948a691f5":s.bind(null,"6511aec7141895e8bedebb549690cdc948a691f5")}},67178:(e,t,r)=>{Promise.resolve().then(r.bind(r,71708))},71708:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var a=r(44297),s=r(65803),n=r(13776),i=r(76858),o=r(81584),d=r(32538),c=r(84811);function l({params:e}){let t=(0,n.useRouter)(),[r,l]=(0,s.useState)(null),[u,p]=(0,s.useState)(!0);return((0,s.useEffect)(()=>{let a;let s=async()=>{try{let r=await fetch(`/api/broadcasts/${e.id}`);if(r.ok){let e=await r.json();l(e),["SCHEDULED","SENDING"].includes(e.status)}else t.push("/broadcast")}catch(e){console.error(e)}finally{p(!1)}};return s(),a=setInterval(()=>{r&&["SCHEDULED","SENDING"].includes(r.status)&&s()},5e3),()=>clearInterval(a)},[e.id,r?.status]),u)?a.jsx("div",{className:"p-8 text-center text-zinc-500",children:"Carregando..."}):r?(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[a.jsx(i.z,{variant:"ghost",size:"icon",onClick:()=>t.push("/broadcast"),children:a.jsx(c.Z,{className:"w-4 h-4"})}),(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-white",children:r.name}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx(d.C,{variant:"outline",children:(e=>{switch(e){case"COMPLETED":return"Conclu\xeddo";case"SENDING":return"Em Envio";case"SCHEDULED":return"Agendado";case"FAILED":return"Falha";case"DRAFT":return"Rascunho";default:return e}})(r.status)}),a.jsx("span",{className:"text-sm text-zinc-500",children:r.page.pageName})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)(o.Zb,{className:"bg-zinc-900/50 border-zinc-800",children:[a.jsx(o.Ol,{className:"pb-2",children:a.jsx(o.ll,{className:"text-sm text-zinc-400",children:"Total P\xfablico"})}),a.jsx(o.aY,{children:a.jsx("div",{className:"text-2xl font-bold text-white",children:r.totalRecipients})})]}),(0,a.jsxs)(o.Zb,{className:"bg-zinc-900/50 border-zinc-800",children:[a.jsx(o.Ol,{className:"pb-2",children:a.jsx(o.ll,{className:"text-sm text-zinc-400",children:"Enviados"})}),a.jsx(o.aY,{children:a.jsx("div",{className:"text-2xl font-bold text-green-500",children:r.totalSent})})]}),(0,a.jsxs)(o.Zb,{className:"bg-zinc-900/50 border-zinc-800",children:[a.jsx(o.Ol,{className:"pb-2",children:a.jsx(o.ll,{className:"text-sm text-zinc-400",children:"Falhas"})}),a.jsx(o.aY,{children:a.jsx("div",{className:"text-2xl font-bold text-red-500",children:r.totalFailed})})]}),(0,a.jsxs)(o.Zb,{className:"bg-zinc-900/50 border-zinc-800",children:[a.jsx(o.Ol,{className:"pb-2",children:a.jsx(o.ll,{className:"text-sm text-zinc-400",children:"Ignorados (Pol\xedtica)"})}),a.jsx(o.aY,{children:a.jsx("div",{className:"text-2xl font-bold text-yellow-500",children:r.totalSkipped})})]})]}),(0,a.jsxs)(o.Zb,{className:"bg-zinc-900/50 border-zinc-800",children:[a.jsx(o.Ol,{children:a.jsx(o.ll,{className:"text-white",children:"Detalhes do Envio"})}),a.jsx(o.aY,{children:(0,a.jsxs)("div",{className:"text-sm text-zinc-400",children:[a.jsx("p",{children:"Os logs detalhados de cada envio est\xe3o dispon\xedveis no banco de dados."}),(0,a.jsxs)("p",{className:"mt-2",children:[a.jsx("b",{children:"Tipo de Mensagem:"})," ",r.messageType]}),(0,a.jsxs)("p",{children:[a.jsx("b",{children:"Pol\xedtica:"})," ",r.policyMode]}),r.totalSkipped>0&&(0,a.jsxs)("div",{className:"mt-4 p-4 bg-yellow-500/10 text-yellow-500 rounded border border-yellow-500/20",children:[r.totalSkipped,' contatos foram ignorados porque estavam fora da janela de 24h e a campanha estava configurada como "Janela 24h (Seguro)".']})]})})]})]}):null}},32538:(e,t,r)=>{"use strict";r.d(t,{C:()=>o});var a=r(44297);r(65803);var s=r(65723),n=r(67952);let i=(0,s.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-500 text-white hover:bg-green-600"}},defaultVariants:{variant:"default"}});function o({className:e,variant:t,...r}){return a.jsx("div",{className:(0,n.cn)(i({variant:t}),e),...r})}},81584:(e,t,r)=>{"use strict";r.d(t,{Ol:()=>o,SZ:()=>c,Zb:()=>i,aY:()=>l,eW:()=>u,ll:()=>d});var a=r(44297),s=r(65803),n=r(67952);let i=s.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));i.displayName="Card";let o=s.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",e),...t}));o.displayName="CardHeader";let d=s.forwardRef(({className:e,...t},r)=>a.jsx("h3",{ref:r,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));d.displayName="CardTitle";let c=s.forwardRef(({className:e,...t},r)=>a.jsx("p",{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",e),...t}));c.displayName="CardDescription";let l=s.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:(0,n.cn)("p-6 pt-0",e),...t}));l.displayName="CardContent";let u=s.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:(0,n.cn)("flex items-center p-6 pt-0",e),...t}));u.displayName="CardFooter"},84811:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(55079).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},46144:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>n,__esModule:()=>s,default:()=>i});let a=(0,r(37460).createProxy)(String.raw`C:\Users\jeang\OneDrive\Desktop\adnext\apps\web\src\app\(dashboard)\broadcast\[id]\page.tsx`),{__esModule:s,$$typeof:n}=a,i=a.default},56087:(e,t,r)=>{"use strict";r.r(t),r.d(t,{createProject:()=>d,deleteProject:()=>l,getProjects:()=>o,updatePageProject:()=>c});var a=r(48437);r(69821);var s=r(56685),n=r(21840),i=r(52841);async function o(){let e=await (0,n.createClient)(),{data:{user:t}}=await e.auth.getUser();return t?(!await s.prisma.user.findUnique({where:{id:t.id}})&&t.email&&await s.prisma.user.create({data:{id:t.id,email:t.email}}).catch(()=>{}),await s.prisma.project.findMany({where:{userId:t.id},include:{pages:{select:{pageId:!0,pageName:!0,isActive:!0}},_count:{select:{pages:!0}}},orderBy:{createdAt:"desc"}})):[]}async function d(e){let t=await (0,n.createClient)(),{data:{user:r}}=await t.auth.getUser();if(!r)throw Error("Unauthorized");let a=e.get("name");if(!a||a.length<3)throw Error("Nome inv\xe1lido (min 3 chars)");let o=a.toLowerCase().replace(/[^a-z0-9]+/g,"-")+"-"+Math.floor(1e4*Math.random());try{return await s.prisma.project.create({data:{userId:r.id,name:a,slug:o}}),(0,i.revalidatePath)("/projects"),{success:!0}}catch(e){return console.error(e),{error:"Erro ao criar projeto"}}}async function c(e,t){let r=await (0,n.createClient)(),{data:{user:a}}=await r.auth.getUser();if(!a)throw Error("Unauthorized");let o=await s.prisma.project.findUnique({where:{id:t}});if(!o||o.userId!==a.id)throw Error("Projeto inv\xe1lido ou sem permiss\xe3o");return await s.prisma.messengerPage.update({where:{pageId:e},data:{projectId:t,userId:a.id}}),(0,i.revalidatePath)("/settings/integracoes"),{success:!0}}async function l(e){let t=await (0,n.createClient)(),{data:{user:r}}=await t.auth.getUser();if(!r)throw Error("Unauthorized");let a=await s.prisma.project.findUnique({where:{id:e},include:{_count:{select:{pages:!0}}}});if(!a||a.userId!==r.id)throw Error("Projeto n\xe3o encontrado");if(a._count.pages>0)throw Error("N\xe3o \xe9 poss\xedvel deletar projeto com p\xe1ginas associadas.");await s.prisma.project.delete({where:{id:e}}),(0,i.revalidatePath)("/projects")}(0,r(64601).ensureServerEntryExports)([o,d,c,l]),(0,a.createActionProxy)("f8668bd5f71af427a636b6031eb02965154b8feb",o),(0,a.createActionProxy)("7a8a07ed673e87719a224ba5bdd94c5abf5790df",d),(0,a.createActionProxy)("7d8e4dd9996424d0e268f2b3af549e67be85e477",c),(0,a.createActionProxy)("67ec2a3b5879da03fd9db50f251cecdfe825c359",l)},56685:(e,t,r)=>{"use strict";r.d(t,{prisma:()=>s});var a=r(53524);let s=globalThis.prisma??new a.PrismaClient({log:["error","warn"]})},21840:(e,t,r)=>{"use strict";r.d(t,{createClient:()=>n});var a=r(43114),s=r(6235);function n(){let e=(0,s.cookies)(),t="https://fmxdqpukjuzhiseyobvz.supabase.co",r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZteGRxcHVranV6aGlzZXlvYnZ6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk2Mjk4MjYsImV4cCI6MjA4NTIwNTgyNn0.bXEJnoTUSzAVDwQNwwiG1gmFc0rfK5M9xbKFMRb48BY";return t&&r||(console.warn("⚠️ Missing Supabase environment variables. Using fallback for build."),"build"!==process.env.npm_lifecycle_event&&t)?(0,a.createServerClient)(t||"",r||"",{cookies:{get:t=>e.get(t)?.value,set(t,r,a){try{e.set({name:t,value:r,...a})}catch(e){}},remove(t,r){try{e.set({name:t,value:"",...r})}catch(e){}}}}):(0,a.createServerClient)(t||"https://placeholder.supabase.co",r||"placeholder",{cookies:{get:()=>void 0,set:()=>{},remove:()=>{}}})}},23960:(e,t,r)=>{"use strict";r.d(t,{mergeDeepRight:()=>a.default});var a=r(95146)},36950:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{DynamicServerError:function(){return a},isDynamicServerError:function(){return s}});let r="DYNAMIC_SERVER_USAGE";class a extends Error{constructor(e){super("Dynamic server usage: "+e),this.description=e,this.digest=r}}function s(e){return"object"==typeof e&&null!==e&&"digest"in e&&"string"==typeof e.digest&&e.digest===r}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},93777:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{isStaticGenBailoutError:function(){return o},staticGenerationBailout:function(){return c}});let a=r(36950),s=r(45869),n="NEXT_STATIC_GEN_BAILOUT";class i extends Error{constructor(...e){super(...e),this.code=n}}function o(e){return"object"==typeof e&&null!==e&&"code"in e&&e.code===n}function d(e,t){let{dynamic:r,link:a}=t||{};return"Page"+(r?' with `dynamic = "'+r+'"`':"")+" couldn't be rendered statically because it used `"+e+"`."+(a?" See more info here: "+a:"")}let c=(e,t)=>{let{dynamic:r,link:n}=void 0===t?{}:t,o=s.staticGenerationAsyncStorage.getStore();if(!o)return!1;if(o.forceStatic)return!0;if(o.dynamicShouldError)throw new i(d(e,{link:n,dynamic:null!=r?r:"error"}));let c=d(e,{dynamic:r,link:"https://nextjs.org/docs/messages/dynamic-server-error"});if(null==o.postpone||o.postpone.call(o,e),o.revalidate=0,o.isStaticGeneration){let t=new a.DynamicServerError(c);throw o.dynamicUsageDescription=e,o.dynamicUsageStack=t.stack,t}return!1};("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[2150,8235,111,4391,1089,2520],()=>r(90291));module.exports=a})();