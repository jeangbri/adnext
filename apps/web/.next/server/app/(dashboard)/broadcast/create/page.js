(()=>{var e={};e.id=6294,e.ids=[6294],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},63234:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>d,routeModule:()=>h,tree:()=>o});var r=a(28090),t=a(79409),l=a(31522),i=a.n(l),n=a(41305),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);a.d(s,c);let o=["",{children:["(dashboard)",{children:["broadcast",{children:["create",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,4541)),"C:\\Users\\jeang\\OneDrive\\Desktop\\adnext\\apps\\web\\src\\app\\(dashboard)\\broadcast\\create\\page.tsx"]}]},{}]},{loading:[()=>Promise.resolve().then(a.bind(a,77845)),"C:\\Users\\jeang\\OneDrive\\Desktop\\adnext\\apps\\web\\src\\app\\(dashboard)\\broadcast\\loading.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,63470)),"C:\\Users\\jeang\\OneDrive\\Desktop\\adnext\\apps\\web\\src\\app\\(dashboard)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,70111,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,13840)),"C:\\Users\\jeang\\OneDrive\\Desktop\\adnext\\apps\\web\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,70111,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\jeang\\OneDrive\\Desktop\\adnext\\apps\\web\\src\\app\\(dashboard)\\broadcast\\create\\page.tsx"],x="/(dashboard)/broadcast/create/page",u={require:a,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:t.x.APP_PAGE,page:"/(dashboard)/broadcast/create/page",pathname:"/broadcast/create",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},84778:(e,s,a)=>{Promise.resolve().then(a.bind(a,47833))},47833:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>b});var r=a(44297),t=a(65803),l=a(13776),i=a(76858),n=a(81584),c=a(82984),o=a(90096),d=a(13894),x=a(54278),u=a(32538),h=a(84811),m=a(92359),p=a(51305);function b(){let e=(0,l.useRouter)(),[s,a]=(0,t.useState)(1),[b,g]=(0,t.useState)(!1),[j,v]=(0,t.useState)([]),[N,f]=(0,t.useState)(""),[T,y]=(0,t.useState)(""),[A,E]=(0,t.useState)("ACTIVE_24H"),[C,_]=(0,t.useState)("24H_ONLY"),[P,w]=(0,t.useState)("ACCOUNT_UPDATE"),[k,z]=(0,t.useState)("TEXT"),[D,O]=(0,t.useState)(""),[U,M]=(0,t.useState)(""),[I,S]=(0,t.useState)([]),[L,q]=(0,t.useState)("IMMEDIATE"),[B,H]=(0,t.useState)("");(0,t.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/messenger/status");if(e.ok){let s=await e.json();v(s.accounts||[])}}catch(e){console.error(e)}})()},[]);let R=async()=>{if(!N||!T)return p.Am.error("Preencha o nome e a p\xe1gina");if(("TEXT"===k||"BUTTON_TEMPLATE"===k)&&!D)return p.Am.error("Digite a mensagem");if("AUDIO"===k&&!U)return p.Am.error("Insira a URL do \xe1udio");if("BUTTON_TEMPLATE"===k&&0===I.length)return p.Am.error("Adicione pelo menos um bot\xe3o");g(!0);try{let s={};"TEXT"===k?s={text:D}:"AUDIO"===k?s={url:U}:"BUTTON_TEMPLATE"===k&&(s={text:D,buttons:I});let a=await fetch("/api/broadcasts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:N,pageId:T,audienceType:A,sendMode:L,scheduledAt:"SCHEDULED"===L?B:void 0,policyMode:C,tag:"TAGGED"===C?P:void 0,messageType:k,payload:s})});if(a.ok)p.Am.success("Campanha criada com sucesso!"),e.push("/broadcast");else{let e=await a.json();p.Am.error(e.error||"Erro ao criar campanha")}}catch(e){p.Am.error("Erro ao conectar com servidor")}finally{g(!1)}};return(0,r.jsxs)("div",{className:"space-y-8 max-w-4xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[r.jsx(i.z,{variant:"ghost",size:"icon",onClick:()=>e.back(),children:r.jsx(h.Z,{className:"w-4 h-4"})}),(0,r.jsxs)("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-white",children:"Nova Campanha"}),r.jsx("p",{className:"text-zinc-400",children:"Configure seu envio em massa"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,r.jsxs)("div",{className:"md:col-span-2 space-y-6",children:[(0,r.jsxs)(n.Zb,{className:"bg-zinc-900/50 border-zinc-800",children:[r.jsx(n.Ol,{children:r.jsx(n.ll,{className:"text-white",children:"1. Configura\xe7\xf5es"})}),(0,r.jsxs)(n.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(o._,{children:"Nome da Campanha"}),r.jsx(c.I,{placeholder:"Ex: Promo\xe7\xe3o Dia das M\xe3es",className:"bg-black/20 border-zinc-700",value:N,onChange:e=>f(e.target.value)})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(o._,{children:"P\xe1gina do Facebook"}),(0,r.jsxs)(d.Ph,{value:T,onValueChange:y,children:[r.jsx(d.i4,{className:"bg-black/20 border-zinc-700",children:r.jsx(d.ki,{placeholder:"Selecione a p\xe1gina"})}),r.jsx(d.Bw,{children:j?.length>0?j.map(e=>r.jsx(d.Ql,{value:e.pageId,children:e.pageName},e.uniqueId||e.pageId)):r.jsx(d.Ql,{value:"loading",disabled:!0,children:"Carregando..."})})]})]})]})]}),(0,r.jsxs)(n.Zb,{className:"bg-zinc-900/50 border-zinc-800",children:[r.jsx(n.Ol,{children:r.jsx(n.ll,{className:"text-white",children:"2. P\xfablico Alvo"})}),(0,r.jsxs)(n.aY,{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:`p-4 rounded-lg border cursor-pointer transition-colors ${"ACTIVE_24H"===A?"bg-[#0084FF]/10 border-[#0084FF] text-white":"bg-black/20 border-zinc-700 text-zinc-400"}`,onClick:()=>E("ACTIVE_24H"),children:[r.jsx("div",{className:"font-bold mb-1",children:"Ativos (24h)"}),r.jsx("div",{className:"text-xs opacity-80",children:"Interagiram nas \xfaltimas 24 horas"})]}),(0,r.jsxs)("div",{className:`p-4 rounded-lg border cursor-pointer transition-colors ${"ALL"===A?"bg-[#0084FF]/10 border-[#0084FF] text-white":"bg-black/20 border-zinc-700 text-zinc-400"}`,onClick:()=>E("ALL"),children:[r.jsx("div",{className:"font-bold mb-1",children:"Todos os Contatos"}),r.jsx("div",{className:"text-xs opacity-80",children:"Base completa (Cuidado 24h)"})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(o._,{children:"Pol\xedtica de Envio (Meta)"}),(0,r.jsxs)(d.Ph,{value:C,onValueChange:_,children:[r.jsx(d.i4,{className:"bg-black/20 border-zinc-700",children:r.jsx(d.ki,{})}),(0,r.jsxs)(d.Bw,{children:[r.jsx(d.Ql,{value:"24H_ONLY",children:"Janela 24h (Padr\xe3o e Seguro)"}),r.jsx(d.Ql,{value:"TAGGED",children:"Message Tags (Fora de 24h)"})]})]}),r.jsx("p",{className:"text-xs text-zinc-500",children:"24H_ONLY"===C?"Envia apenas para usu\xe1rios que interagiram nas \xfaltimas 24h. Outros ser\xe3o ignorados.":"Permite enviar fora de 24h usando Tags. Use com cuidado para n\xe3o ser bloqueado."})]}),"TAGGED"===C&&(0,r.jsxs)("div",{className:"space-y-2 p-4 bg-yellow-500/10 rounded-md border border-yellow-500/20",children:[r.jsx(o._,{className:"text-yellow-500",children:"Selecione a Tag"}),(0,r.jsxs)(d.Ph,{value:P,onValueChange:w,children:[r.jsx(d.i4,{className:"bg-black/20 border-zinc-700",children:r.jsx(d.ki,{})}),(0,r.jsxs)(d.Bw,{children:[r.jsx(d.Ql,{value:"ACCOUNT_UPDATE",children:"CONFIRMED_EVENT_UPDATE (Lembretes de evento)"}),r.jsx(d.Ql,{value:"POST_PURCHASE_UPDATE",children:"POST_PURCHASE_UPDATE (Atualiza\xe7\xe3o de pedido)"}),r.jsx(d.Ql,{value:"ACCOUNT_UPDATE",children:"ACCOUNT_UPDATE (Atualiza\xe7\xe3o de conta)"}),r.jsx(d.Ql,{value:"HUMAN_AGENT",children:"HUMAN_AGENT (Resposta humana)"})]})]})]})]})]}),(0,r.jsxs)(n.Zb,{className:"bg-zinc-900/50 border-zinc-800",children:[r.jsx(n.Ol,{children:r.jsx(n.ll,{className:"text-white",children:"3. Mensagem"})}),(0,r.jsxs)(n.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(o._,{children:"Tipo de Mensagem"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx(i.z,{variant:"TEXT"===k?"default":"outline",onClick:()=>z("TEXT"),className:"flex-1",children:"Texto"}),r.jsx(i.z,{variant:"BUTTON_TEMPLATE"===k?"default":"outline",onClick:()=>z("BUTTON_TEMPLATE"),className:"flex-1",children:"Texto + Bot\xf5es"}),r.jsx(i.z,{variant:"AUDIO"===k?"default":"outline",onClick:()=>z("AUDIO"),className:"flex-1",children:"\xc1udio"})]})]}),"TEXT"===k&&(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(o._,{children:"Conte\xfado do Texto"}),r.jsx(x.g,{placeholder:"Ol\xe1 {{first_name}}, temos novidades...",className:"bg-black/20 border-zinc-700 min-h-[100px]",value:D,onChange:e=>O(e.target.value)})]}),"BUTTON_TEMPLATE"===k&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(o._,{children:"Texto da Mensagem"}),r.jsx(x.g,{placeholder:"Clique no bot\xe3o abaixo...",className:"bg-black/20 border-zinc-700",value:D,onChange:e=>O(e.target.value)})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(o._,{children:"Bot\xf5es (M\xe1x 3)"}),I.map((e,s)=>(0,r.jsxs)("div",{className:"flex gap-2 items-center",children:[r.jsx(c.I,{placeholder:"T\xedtulo do Bot\xe3o",value:e.title,onChange:e=>{let a=[...I];a[s].title=e.target.value,S(a)},className:"bg-black/20 border-zinc-700 flex-1"}),r.jsx(c.I,{placeholder:"URL (https://...)",value:e.url,onChange:e=>{let a=[...I];a[s].url=e.target.value,S(a)},className:"bg-black/20 border-zinc-700 flex-1"}),r.jsx(i.z,{variant:"ghost",size:"icon",onClick:()=>{S(I.filter((e,a)=>a!==s))},children:"x"})]},s)),I.length<3&&r.jsx(i.z,{variant:"outline",size:"sm",onClick:()=>S([...I,{type:"web_url",title:"",url:""}]),className:"w-full border-dashed",children:"+ Adicionar Bot\xe3o"})]})]}),"AUDIO"===k&&(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(o._,{children:"URL do \xc1udio (MP3/OGG)"}),r.jsx(c.I,{placeholder:"https://exemplo.com/audio.mp3",className:"bg-black/20 border-zinc-700",value:U,onChange:e=>M(e.target.value)}),r.jsx("p",{className:"text-xs text-zinc-500",children:"O arquivo deve ser p\xfablico e acess\xedvel pela Meta."})]})]})]}),(0,r.jsxs)(n.Zb,{className:"bg-zinc-900/50 border-zinc-800",children:[r.jsx(n.Ol,{children:r.jsx(n.ll,{className:"text-white",children:"4. Agendamento"})}),(0,r.jsxs)(n.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(o._,{children:"Quando enviar?"}),(0,r.jsxs)(d.Ph,{value:L,onValueChange:q,children:[r.jsx(d.i4,{className:"bg-black/20 border-zinc-700",children:r.jsx(d.ki,{})}),(0,r.jsxs)(d.Bw,{children:[r.jsx(d.Ql,{value:"IMMEDIATE",children:"Enviar Imediatamente"}),r.jsx(d.Ql,{value:"SCHEDULED",children:"Agendar"})]})]})]}),"SCHEDULED"===L&&(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(o._,{children:"Data e Hora"}),r.jsx(c.I,{type:"datetime-local",className:"bg-black/20 border-zinc-700",value:B,onChange:e=>H(e.target.value)})]})]})]})]}),r.jsx("div",{className:"md:col-span-1",children:r.jsx("div",{className:"sticky top-6 space-y-4",children:(0,r.jsxs)(n.Zb,{className:"bg-zinc-900 border-zinc-800",children:[r.jsx(n.Ol,{children:r.jsx(n.ll,{className:"text-sm text-zinc-400 uppercase tracking-wider",children:"Resumo"})}),(0,r.jsxs)(n.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("div",{className:"text-xs text-zinc-500",children:"P\xe1gina"}),r.jsx("div",{className:"text-white font-medium",children:j.find(e=>e.pageId===T)?.pageName||"-"})]}),(0,r.jsxs)("div",{children:[r.jsx("div",{className:"text-xs text-zinc-500",children:"P\xfablico"}),r.jsx(u.C,{variant:"outline",children:A})]}),(0,r.jsxs)("div",{children:[r.jsx("div",{className:"text-xs text-zinc-500",children:"Pol\xedtica"}),r.jsx("div",{className:"text-white font-medium",children:C})]}),(0,r.jsxs)(i.z,{className:"w-full bg-[#0084FF] hover:bg-[#0070D1] text-white mt-4",onClick:R,disabled:b,children:[b&&r.jsx(m.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"IMMEDIATE"===L?"Enviar Agora":"Agendar Campanha"]})]})]})})})]})]})}},82984:(e,s,a)=>{"use strict";a.d(s,{I:()=>i});var r=a(44297),t=a(65803),l=a(67952);let i=t.forwardRef(({className:e,type:s,...a},t)=>r.jsx("input",{type:s,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:t,...a}));i.displayName="Input"},90096:(e,s,a)=>{"use strict";a.d(s,{_:()=>d});var r=a(44297),t=a(65803),l=a(82455),i=t.forwardRef((e,s)=>(0,r.jsx)(l.WV.label,{...e,ref:s,onMouseDown:s=>{s.target.closest("button, input, select, textarea")||(e.onMouseDown?.(s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));i.displayName="Label";var n=a(65723),c=a(67952);let o=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=t.forwardRef(({className:e,...s},a)=>r.jsx(i,{ref:a,className:(0,c.cn)(o(),e),...s}));d.displayName=i.displayName},54278:(e,s,a)=>{"use strict";a.d(s,{g:()=>i});var r=a(44297),t=a(65803),l=a(67952);let i=t.forwardRef(({className:e,...s},a)=>r.jsx("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...s}));i.displayName="Textarea"},84811:(e,s,a)=>{"use strict";a.d(s,{Z:()=>r});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(55079).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},4541:(e,s,a)=>{"use strict";a.r(s),a.d(s,{$$typeof:()=>l,__esModule:()=>t,default:()=>i});let r=(0,a(37460).createProxy)(String.raw`C:\Users\jeang\OneDrive\Desktop\adnext\apps\web\src\app\(dashboard)\broadcast\create\page.tsx`),{__esModule:t,$$typeof:l}=r,i=r.default},82455:(e,s,a)=>{"use strict";a.d(s,{WV:()=>i});var r=a(65803);a(42182);var t=a(63551),l=a(44297),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,s)=>{let a=(0,t.Z8)(`Primitive.${s}`),i=r.forwardRef((e,r)=>{let{asChild:t,...i}=e,n=t?a:s;return(0,l.jsx)(n,{...i,ref:r})});return i.displayName=`Primitive.${s}`,{...e,[s]:i}},{})}};var s=require("../../../../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),r=s.X(0,[2150,8235,111,3955,1089,3321,2520,5118],()=>a(63234));module.exports=r})();