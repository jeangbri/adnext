(()=>{var e={};e.id=6294,e.ids=[6294],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},63234:(e,a,r)=>{"use strict";r.r(a),r.d(a,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>x,tree:()=>c});var s=r(28090),t=r(79409),i=r(31522),n=r.n(i),l=r(41305),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(a,o);let c=["",{children:["(dashboard)",{children:["broadcast",{children:["create",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,4541)),"C:\\Users\\jeang\\OneDrive\\Desktop\\adnext\\apps\\web\\src\\app\\(dashboard)\\broadcast\\create\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,63470)),"C:\\Users\\jeang\\OneDrive\\Desktop\\adnext\\apps\\web\\src\\app\\(dashboard)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,70111,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,13840)),"C:\\Users\\jeang\\OneDrive\\Desktop\\adnext\\apps\\web\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,70111,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\jeang\\OneDrive\\Desktop\\adnext\\apps\\web\\src\\app\\(dashboard)\\broadcast\\create\\page.tsx"],u="/(dashboard)/broadcast/create/page",p={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:t.x.APP_PAGE,page:"/(dashboard)/broadcast/create/page",pathname:"/broadcast/create",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},57409:(e,a,r)=>{let s={"67ec2a3b5879da03fd9db50f251cecdfe825c359":()=>Promise.resolve().then(r.bind(r,56087)).then(e=>e.deleteProject),"7a8a07ed673e87719a224ba5bdd94c5abf5790df":()=>Promise.resolve().then(r.bind(r,56087)).then(e=>e.createProject),"7d8e4dd9996424d0e268f2b3af549e67be85e477":()=>Promise.resolve().then(r.bind(r,56087)).then(e=>e.updatePageProject),f8668bd5f71af427a636b6031eb02965154b8feb:()=>Promise.resolve().then(r.bind(r,56087)).then(e=>e.getProjects),"6511aec7141895e8bedebb549690cdc948a691f5":()=>Promise.resolve().then(r.bind(r,80736)).then(e=>e.setContext)};async function t(e,...a){return(await s[e]()).apply(null,a)}e.exports={"67ec2a3b5879da03fd9db50f251cecdfe825c359":t.bind(null,"67ec2a3b5879da03fd9db50f251cecdfe825c359"),"7a8a07ed673e87719a224ba5bdd94c5abf5790df":t.bind(null,"7a8a07ed673e87719a224ba5bdd94c5abf5790df"),"7d8e4dd9996424d0e268f2b3af549e67be85e477":t.bind(null,"7d8e4dd9996424d0e268f2b3af549e67be85e477"),f8668bd5f71af427a636b6031eb02965154b8feb:t.bind(null,"f8668bd5f71af427a636b6031eb02965154b8feb"),"6511aec7141895e8bedebb549690cdc948a691f5":t.bind(null,"6511aec7141895e8bedebb549690cdc948a691f5")}},84778:(e,a,r)=>{Promise.resolve().then(r.bind(r,47833))},47833:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>b});var s=r(44297),t=r(65803),i=r(13776),n=r(76858),l=r(81584),o=r(82984),c=r(90096),d=r(13894),u=r(54278),p=r(32538),x=r(84811),m=r(92359),h=r(51305);function b(){let e=(0,i.useRouter)(),[a,r]=(0,t.useState)(1),[b,f]=(0,t.useState)(!1),[g,v]=(0,t.useState)([]),[j,N]=(0,t.useState)(""),[y,w]=(0,t.useState)(""),[E,P]=(0,t.useState)("ACTIVE_24H"),[T,C]=(0,t.useState)("24H_ONLY"),[_,A]=(0,t.useState)("ACCOUNT_UPDATE"),[k,z]=(0,t.useState)("TEXT"),[U,I]=(0,t.useState)(""),[D,O]=(0,t.useState)(""),[M,S]=(0,t.useState)([]),[R,L]=(0,t.useState)("IMMEDIATE"),[G,q]=(0,t.useState)("");(0,t.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/messenger/status");if(e.ok){let a=await e.json();v(a.accounts||[])}}catch(e){console.error(e)}})()},[]);let B=async()=>{if(!j||!y)return h.Am.error("Preencha o nome e a p\xe1gina");if(("TEXT"===k||"BUTTON_TEMPLATE"===k)&&!U)return h.Am.error("Digite a mensagem");if("AUDIO"===k&&!D)return h.Am.error("Insira a URL do \xe1udio");if("BUTTON_TEMPLATE"===k&&0===M.length)return h.Am.error("Adicione pelo menos um bot\xe3o");f(!0);try{let a={};"TEXT"===k?a={text:U}:"AUDIO"===k?a={url:D}:"BUTTON_TEMPLATE"===k&&(a={text:U,buttons:M});let r=await fetch("/api/broadcasts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:j,pageId:y,audienceType:E,sendMode:R,scheduledAt:"SCHEDULED"===R?G:void 0,policyMode:T,tag:"TAGGED"===T?_:void 0,messageType:k,payload:a})});if(r.ok)h.Am.success("Campanha criada com sucesso!"),e.push("/broadcast");else{let e=await r.json();h.Am.error(e.error||"Erro ao criar campanha")}}catch(e){h.Am.error("Erro ao conectar com servidor")}finally{f(!1)}};return(0,s.jsxs)("div",{className:"space-y-8 max-w-4xl mx-auto",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[s.jsx(n.z,{variant:"ghost",size:"icon",onClick:()=>e.back(),children:s.jsx(x.Z,{className:"w-4 h-4"})}),(0,s.jsxs)("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-white",children:"Nova Campanha"}),s.jsx("p",{className:"text-zinc-400",children:"Configure seu envio em massa"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,s.jsxs)("div",{className:"md:col-span-2 space-y-6",children:[(0,s.jsxs)(l.Zb,{className:"bg-zinc-900/50 border-zinc-800",children:[s.jsx(l.Ol,{children:s.jsx(l.ll,{className:"text-white",children:"1. Configura\xe7\xf5es"})}),(0,s.jsxs)(l.aY,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(c._,{children:"Nome da Campanha"}),s.jsx(o.I,{placeholder:"Ex: Promo\xe7\xe3o Dia das M\xe3es",className:"bg-black/20 border-zinc-700",value:j,onChange:e=>N(e.target.value)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(c._,{children:"P\xe1gina do Facebook"}),(0,s.jsxs)(d.Ph,{value:y,onValueChange:w,children:[s.jsx(d.i4,{className:"bg-black/20 border-zinc-700",children:s.jsx(d.ki,{placeholder:"Selecione a p\xe1gina"})}),s.jsx(d.Bw,{children:g?.length>0?g.map(e=>s.jsx(d.Ql,{value:e.pageId,children:e.pageName},e.uniqueId||e.pageId)):s.jsx(d.Ql,{value:"loading",disabled:!0,children:"Carregando..."})})]})]})]})]}),(0,s.jsxs)(l.Zb,{className:"bg-zinc-900/50 border-zinc-800",children:[s.jsx(l.Ol,{children:s.jsx(l.ll,{className:"text-white",children:"2. P\xfablico Alvo"})}),(0,s.jsxs)(l.aY,{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:`p-4 rounded-lg border cursor-pointer transition-colors ${"ACTIVE_24H"===E?"bg-[#0084FF]/10 border-[#0084FF] text-white":"bg-black/20 border-zinc-700 text-zinc-400"}`,onClick:()=>P("ACTIVE_24H"),children:[s.jsx("div",{className:"font-bold mb-1",children:"Ativos (24h)"}),s.jsx("div",{className:"text-xs opacity-80",children:"Interagiram nas \xfaltimas 24 horas"})]}),(0,s.jsxs)("div",{className:`p-4 rounded-lg border cursor-pointer transition-colors ${"ALL"===E?"bg-[#0084FF]/10 border-[#0084FF] text-white":"bg-black/20 border-zinc-700 text-zinc-400"}`,onClick:()=>P("ALL"),children:[s.jsx("div",{className:"font-bold mb-1",children:"Todos os Contatos"}),s.jsx("div",{className:"text-xs opacity-80",children:"Base completa (Cuidado 24h)"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(c._,{children:"Pol\xedtica de Envio (Meta)"}),(0,s.jsxs)(d.Ph,{value:T,onValueChange:C,children:[s.jsx(d.i4,{className:"bg-black/20 border-zinc-700",children:s.jsx(d.ki,{})}),(0,s.jsxs)(d.Bw,{children:[s.jsx(d.Ql,{value:"24H_ONLY",children:"Janela 24h (Padr\xe3o e Seguro)"}),s.jsx(d.Ql,{value:"TAGGED",children:"Message Tags (Fora de 24h)"})]})]}),s.jsx("p",{className:"text-xs text-zinc-500",children:"24H_ONLY"===T?"Envia apenas para usu\xe1rios que interagiram nas \xfaltimas 24h. Outros ser\xe3o ignorados.":"Permite enviar fora de 24h usando Tags. Use com cuidado para n\xe3o ser bloqueado."})]}),"TAGGED"===T&&(0,s.jsxs)("div",{className:"space-y-2 p-4 bg-yellow-500/10 rounded-md border border-yellow-500/20",children:[s.jsx(c._,{className:"text-yellow-500",children:"Selecione a Tag"}),(0,s.jsxs)(d.Ph,{value:_,onValueChange:A,children:[s.jsx(d.i4,{className:"bg-black/20 border-zinc-700",children:s.jsx(d.ki,{})}),(0,s.jsxs)(d.Bw,{children:[s.jsx(d.Ql,{value:"ACCOUNT_UPDATE",children:"CONFIRMED_EVENT_UPDATE (Lembretes de evento)"}),s.jsx(d.Ql,{value:"POST_PURCHASE_UPDATE",children:"POST_PURCHASE_UPDATE (Atualiza\xe7\xe3o de pedido)"}),s.jsx(d.Ql,{value:"ACCOUNT_UPDATE",children:"ACCOUNT_UPDATE (Atualiza\xe7\xe3o de conta)"}),s.jsx(d.Ql,{value:"HUMAN_AGENT",children:"HUMAN_AGENT (Resposta humana)"})]})]})]})]})]}),(0,s.jsxs)(l.Zb,{className:"bg-zinc-900/50 border-zinc-800",children:[s.jsx(l.Ol,{children:s.jsx(l.ll,{className:"text-white",children:"3. Mensagem"})}),(0,s.jsxs)(l.aY,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(c._,{children:"Tipo de Mensagem"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx(n.z,{variant:"TEXT"===k?"default":"outline",onClick:()=>z("TEXT"),className:"flex-1",children:"Texto"}),s.jsx(n.z,{variant:"BUTTON_TEMPLATE"===k?"default":"outline",onClick:()=>z("BUTTON_TEMPLATE"),className:"flex-1",children:"Texto + Bot\xf5es"}),s.jsx(n.z,{variant:"AUDIO"===k?"default":"outline",onClick:()=>z("AUDIO"),className:"flex-1",children:"\xc1udio"})]})]}),"TEXT"===k&&(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(c._,{children:"Conte\xfado do Texto"}),s.jsx(u.g,{placeholder:"Ol\xe1 {{first_name}}, temos novidades...",className:"bg-black/20 border-zinc-700 min-h-[100px]",value:U,onChange:e=>I(e.target.value)})]}),"BUTTON_TEMPLATE"===k&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(c._,{children:"Texto da Mensagem"}),s.jsx(u.g,{placeholder:"Clique no bot\xe3o abaixo...",className:"bg-black/20 border-zinc-700",value:U,onChange:e=>I(e.target.value)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(c._,{children:"Bot\xf5es (M\xe1x 3)"}),M.map((e,a)=>(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[s.jsx(o.I,{placeholder:"T\xedtulo do Bot\xe3o",value:e.title,onChange:e=>{let r=[...M];r[a].title=e.target.value,S(r)},className:"bg-black/20 border-zinc-700 flex-1"}),s.jsx(o.I,{placeholder:"URL (https://...)",value:e.url,onChange:e=>{let r=[...M];r[a].url=e.target.value,S(r)},className:"bg-black/20 border-zinc-700 flex-1"}),s.jsx(n.z,{variant:"ghost",size:"icon",onClick:()=>{S(M.filter((e,r)=>r!==a))},children:"x"})]},a)),M.length<3&&s.jsx(n.z,{variant:"outline",size:"sm",onClick:()=>S([...M,{type:"web_url",title:"",url:""}]),className:"w-full border-dashed",children:"+ Adicionar Bot\xe3o"})]})]}),"AUDIO"===k&&(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(c._,{children:"URL do \xc1udio (MP3/OGG)"}),s.jsx(o.I,{placeholder:"https://exemplo.com/audio.mp3",className:"bg-black/20 border-zinc-700",value:D,onChange:e=>O(e.target.value)}),s.jsx("p",{className:"text-xs text-zinc-500",children:"O arquivo deve ser p\xfablico e acess\xedvel pela Meta."})]})]})]}),(0,s.jsxs)(l.Zb,{className:"bg-zinc-900/50 border-zinc-800",children:[s.jsx(l.Ol,{children:s.jsx(l.ll,{className:"text-white",children:"4. Agendamento"})}),(0,s.jsxs)(l.aY,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(c._,{children:"Quando enviar?"}),(0,s.jsxs)(d.Ph,{value:R,onValueChange:L,children:[s.jsx(d.i4,{className:"bg-black/20 border-zinc-700",children:s.jsx(d.ki,{})}),(0,s.jsxs)(d.Bw,{children:[s.jsx(d.Ql,{value:"IMMEDIATE",children:"Enviar Imediatamente"}),s.jsx(d.Ql,{value:"SCHEDULED",children:"Agendar"})]})]})]}),"SCHEDULED"===R&&(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(c._,{children:"Data e Hora"}),s.jsx(o.I,{type:"datetime-local",className:"bg-black/20 border-zinc-700",value:G,onChange:e=>q(e.target.value)})]})]})]})]}),s.jsx("div",{className:"md:col-span-1",children:s.jsx("div",{className:"sticky top-6 space-y-4",children:(0,s.jsxs)(l.Zb,{className:"bg-zinc-900 border-zinc-800",children:[s.jsx(l.Ol,{children:s.jsx(l.ll,{className:"text-sm text-zinc-400 uppercase tracking-wider",children:"Resumo"})}),(0,s.jsxs)(l.aY,{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[s.jsx("div",{className:"text-xs text-zinc-500",children:"P\xe1gina"}),s.jsx("div",{className:"text-white font-medium",children:g.find(e=>e.pageId===y)?.pageName||"-"})]}),(0,s.jsxs)("div",{children:[s.jsx("div",{className:"text-xs text-zinc-500",children:"P\xfablico"}),s.jsx(p.C,{variant:"outline",children:E})]}),(0,s.jsxs)("div",{children:[s.jsx("div",{className:"text-xs text-zinc-500",children:"Pol\xedtica"}),s.jsx("div",{className:"text-white font-medium",children:T})]}),(0,s.jsxs)(n.z,{className:"w-full bg-[#0084FF] hover:bg-[#0070D1] text-white mt-4",onClick:B,disabled:b,children:[b&&s.jsx(m.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"IMMEDIATE"===R?"Enviar Agora":"Agendar Campanha"]})]})]})})})]})]})}},32538:(e,a,r)=>{"use strict";r.d(a,{C:()=>l});var s=r(44297);r(65803);var t=r(65723),i=r(67952);let n=(0,t.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-500 text-white hover:bg-green-600"}},defaultVariants:{variant:"default"}});function l({className:e,variant:a,...r}){return s.jsx("div",{className:(0,i.cn)(n({variant:a}),e),...r})}},81584:(e,a,r)=>{"use strict";r.d(a,{Ol:()=>l,SZ:()=>c,Zb:()=>n,aY:()=>d,eW:()=>u,ll:()=>o});var s=r(44297),t=r(65803),i=r(67952);let n=t.forwardRef(({className:e,...a},r)=>s.jsx("div",{ref:r,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...a}));n.displayName="Card";let l=t.forwardRef(({className:e,...a},r)=>s.jsx("div",{ref:r,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...a}));l.displayName="CardHeader";let o=t.forwardRef(({className:e,...a},r)=>s.jsx("h3",{ref:r,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...a}));o.displayName="CardTitle";let c=t.forwardRef(({className:e,...a},r)=>s.jsx("p",{ref:r,className:(0,i.cn)("text-sm text-muted-foreground",e),...a}));c.displayName="CardDescription";let d=t.forwardRef(({className:e,...a},r)=>s.jsx("div",{ref:r,className:(0,i.cn)("p-6 pt-0",e),...a}));d.displayName="CardContent";let u=t.forwardRef(({className:e,...a},r)=>s.jsx("div",{ref:r,className:(0,i.cn)("flex items-center p-6 pt-0",e),...a}));u.displayName="CardFooter"},82984:(e,a,r)=>{"use strict";r.d(a,{I:()=>n});var s=r(44297),t=r(65803),i=r(67952);let n=t.forwardRef(({className:e,type:a,...r},t)=>s.jsx("input",{type:a,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:t,...r}));n.displayName="Input"},90096:(e,a,r)=>{"use strict";r.d(a,{_:()=>d});var s=r(44297),t=r(65803),i=r(82455),n=t.forwardRef((e,a)=>(0,s.jsx)(i.WV.label,{...e,ref:a,onMouseDown:a=>{a.target.closest("button, input, select, textarea")||(e.onMouseDown?.(a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));n.displayName="Label";var l=r(65723),o=r(67952);let c=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=t.forwardRef(({className:e,...a},r)=>s.jsx(n,{ref:r,className:(0,o.cn)(c(),e),...a}));d.displayName=n.displayName},54278:(e,a,r)=>{"use strict";r.d(a,{g:()=>n});var s=r(44297),t=r(65803),i=r(67952);let n=t.forwardRef(({className:e,...a},r)=>s.jsx("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...a}));n.displayName="Textarea"},84811:(e,a,r)=>{"use strict";r.d(a,{Z:()=>s});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(55079).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},92359:(e,a,r)=>{"use strict";r.d(a,{Z:()=>s});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(55079).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},4541:(e,a,r)=>{"use strict";r.r(a),r.d(a,{$$typeof:()=>i,__esModule:()=>t,default:()=>n});let s=(0,r(37460).createProxy)(String.raw`C:\Users\jeang\OneDrive\Desktop\adnext\apps\web\src\app\(dashboard)\broadcast\create\page.tsx`),{__esModule:t,$$typeof:i}=s,n=s.default},56087:(e,a,r)=>{"use strict";r.r(a),r.d(a,{createProject:()=>o,deleteProject:()=>d,getProjects:()=>l,updatePageProject:()=>c});var s=r(48437);r(69821);var t=r(56685),i=r(21840),n=r(52841);async function l(){let e=await (0,i.createClient)(),{data:{user:a}}=await e.auth.getUser();return a?(!await t.prisma.user.findUnique({where:{id:a.id}})&&a.email&&await t.prisma.user.create({data:{id:a.id,email:a.email}}).catch(()=>{}),await t.prisma.project.findMany({where:{userId:a.id},include:{pages:{select:{pageId:!0,pageName:!0,isActive:!0}},_count:{select:{pages:!0}}},orderBy:{createdAt:"desc"}})):[]}async function o(e){let a=await (0,i.createClient)(),{data:{user:r}}=await a.auth.getUser();if(!r)throw Error("Unauthorized");let s=e.get("name");if(!s||s.length<3)throw Error("Nome inv\xe1lido (min 3 chars)");let l=s.toLowerCase().replace(/[^a-z0-9]+/g,"-")+"-"+Math.floor(1e4*Math.random());try{return await t.prisma.project.create({data:{userId:r.id,name:s,slug:l}}),(0,n.revalidatePath)("/projects"),{success:!0}}catch(e){return console.error(e),{error:"Erro ao criar projeto"}}}async function c(e,a){let r=await (0,i.createClient)(),{data:{user:s}}=await r.auth.getUser();if(!s)throw Error("Unauthorized");let l=await t.prisma.project.findUnique({where:{id:a}});if(!l||l.userId!==s.id)throw Error("Projeto inv\xe1lido ou sem permiss\xe3o");return await t.prisma.messengerPage.update({where:{pageId:e},data:{projectId:a,userId:s.id}}),(0,n.revalidatePath)("/settings/integracoes"),{success:!0}}async function d(e){let a=await (0,i.createClient)(),{data:{user:r}}=await a.auth.getUser();if(!r)throw Error("Unauthorized");let s=await t.prisma.project.findUnique({where:{id:e},include:{_count:{select:{pages:!0}}}});if(!s||s.userId!==r.id)throw Error("Projeto n\xe3o encontrado");if(s._count.pages>0)throw Error("N\xe3o \xe9 poss\xedvel deletar projeto com p\xe1ginas associadas.");await t.prisma.project.delete({where:{id:e}}),(0,n.revalidatePath)("/projects")}(0,r(64601).ensureServerEntryExports)([l,o,c,d]),(0,s.createActionProxy)("f8668bd5f71af427a636b6031eb02965154b8feb",l),(0,s.createActionProxy)("7a8a07ed673e87719a224ba5bdd94c5abf5790df",o),(0,s.createActionProxy)("7d8e4dd9996424d0e268f2b3af549e67be85e477",c),(0,s.createActionProxy)("67ec2a3b5879da03fd9db50f251cecdfe825c359",d)},56685:(e,a,r)=>{"use strict";r.d(a,{prisma:()=>t});var s=r(53524);let t=globalThis.prisma??new s.PrismaClient({log:["error","warn"]})},21840:(e,a,r)=>{"use strict";r.d(a,{createClient:()=>i});var s=r(43114),t=r(6235);function i(){let e=(0,t.cookies)(),a="https://fmxdqpukjuzhiseyobvz.supabase.co",r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZteGRxcHVranV6aGlzZXlvYnZ6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk2Mjk4MjYsImV4cCI6MjA4NTIwNTgyNn0.bXEJnoTUSzAVDwQNwwiG1gmFc0rfK5M9xbKFMRb48BY";return a&&r||(console.warn("⚠️ Missing Supabase environment variables. Using fallback for build."),"build"!==process.env.npm_lifecycle_event&&a)?(0,s.createServerClient)(a||"",r||"",{cookies:{get:a=>e.get(a)?.value,set(a,r,s){try{e.set({name:a,value:r,...s})}catch(e){}},remove(a,r){try{e.set({name:a,value:"",...r})}catch(e){}}}}):(0,s.createServerClient)(a||"https://placeholder.supabase.co",r||"placeholder",{cookies:{get:()=>void 0,set:()=>{},remove:()=>{}}})}},23960:(e,a,r)=>{"use strict";r.d(a,{mergeDeepRight:()=>s.default});var s=r(95146)},36950:(e,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),function(e,a){for(var r in a)Object.defineProperty(e,r,{enumerable:!0,get:a[r]})}(a,{DynamicServerError:function(){return s},isDynamicServerError:function(){return t}});let r="DYNAMIC_SERVER_USAGE";class s extends Error{constructor(e){super("Dynamic server usage: "+e),this.description=e,this.digest=r}}function t(e){return"object"==typeof e&&null!==e&&"digest"in e&&"string"==typeof e.digest&&e.digest===r}("function"==typeof a.default||"object"==typeof a.default&&null!==a.default)&&void 0===a.default.__esModule&&(Object.defineProperty(a.default,"__esModule",{value:!0}),Object.assign(a.default,a),e.exports=a.default)},93777:(e,a,r)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),function(e,a){for(var r in a)Object.defineProperty(e,r,{enumerable:!0,get:a[r]})}(a,{isStaticGenBailoutError:function(){return l},staticGenerationBailout:function(){return c}});let s=r(36950),t=r(45869),i="NEXT_STATIC_GEN_BAILOUT";class n extends Error{constructor(...e){super(...e),this.code=i}}function l(e){return"object"==typeof e&&null!==e&&"code"in e&&e.code===i}function o(e,a){let{dynamic:r,link:s}=a||{};return"Page"+(r?' with `dynamic = "'+r+'"`':"")+" couldn't be rendered statically because it used `"+e+"`."+(s?" See more info here: "+s:"")}let c=(e,a)=>{let{dynamic:r,link:i}=void 0===a?{}:a,l=t.staticGenerationAsyncStorage.getStore();if(!l)return!1;if(l.forceStatic)return!0;if(l.dynamicShouldError)throw new n(o(e,{link:i,dynamic:null!=r?r:"error"}));let c=o(e,{dynamic:r,link:"https://nextjs.org/docs/messages/dynamic-server-error"});if(null==l.postpone||l.postpone.call(l,e),l.revalidate=0,l.isStaticGeneration){let a=new s.DynamicServerError(c);throw l.dynamicUsageDescription=e,l.dynamicUsageStack=a.stack,a}return!1};("function"==typeof a.default||"object"==typeof a.default&&null!==a.default)&&void 0===a.default.__esModule&&(Object.defineProperty(a.default,"__esModule",{value:!0}),Object.assign(a.default,a),e.exports=a.default)},82455:(e,a,r)=>{"use strict";r.d(a,{WV:()=>n});var s=r(65803);r(42182);var t=r(63551),i=r(44297),n=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,a)=>{let r=(0,t.Z8)(`Primitive.${a}`),n=s.forwardRef((e,s)=>{let{asChild:t,...n}=e,l=t?r:a;return(0,i.jsx)(l,{...n,ref:s})});return n.displayName=`Primitive.${a}`,{...e,[a]:n}},{})}};var a=require("../../../../webpack-runtime.js");a.C(e);var r=e=>a(a.s=e),s=a.X(0,[2150,8235,111,4391,1089,2520],()=>r(63234));module.exports=s})();