exports.id=418,exports.ids=[418],exports.modules={57409:(e,a,s)=>{let t={"67ec2a3b5879da03fd9db50f251cecdfe825c359":()=>Promise.resolve().then(s.bind(s,56087)).then(e=>e.deleteProject),"7a8a07ed673e87719a224ba5bdd94c5abf5790df":()=>Promise.resolve().then(s.bind(s,56087)).then(e=>e.createProject),"7d8e4dd9996424d0e268f2b3af549e67be85e477":()=>Promise.resolve().then(s.bind(s,56087)).then(e=>e.updatePageProject),f8668bd5f71af427a636b6031eb02965154b8feb:()=>Promise.resolve().then(s.bind(s,56087)).then(e=>e.getProjects),"6511aec7141895e8bedebb549690cdc948a691f5":()=>Promise.resolve().then(s.bind(s,80736)).then(e=>e.setContext)};async function r(e,...a){return(await t[e]()).apply(null,a)}e.exports={"67ec2a3b5879da03fd9db50f251cecdfe825c359":r.bind(null,"67ec2a3b5879da03fd9db50f251cecdfe825c359"),"7a8a07ed673e87719a224ba5bdd94c5abf5790df":r.bind(null,"7a8a07ed673e87719a224ba5bdd94c5abf5790df"),"7d8e4dd9996424d0e268f2b3af549e67be85e477":r.bind(null,"7d8e4dd9996424d0e268f2b3af549e67be85e477"),f8668bd5f71af427a636b6031eb02965154b8feb:r.bind(null,"f8668bd5f71af427a636b6031eb02965154b8feb"),"6511aec7141895e8bedebb549690cdc948a691f5":r.bind(null,"6511aec7141895e8bedebb549690cdc948a691f5")}},50373:(e,a,s)=>{Promise.resolve().then(s.bind(s,40432))},38146:()=>{},40432:(e,a,s)=>{"use strict";s.r(a),s.d(a,{RuleEditor:()=>_});var t=s(44297),r=s(65803),l=s(13776),i=s(8911),n=s(76858),c=s(82984),d=s(80541),o=s(81584),x=s(90096),m=s(32538),p=s(84811),h=s(92359),u=s(42682),b=s(97545),g=s(66606),f=s(93862),j=s(55079);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let N=(0,j.Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),v=(0,j.Z)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),y=(0,j.Z)("Ratio",[["rect",{width:"12",height:"20",x:"6",y:"2",rx:"2",key:"1oxtiu"}],["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}]]),w=(0,j.Z)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),z=(0,j.Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),k=(0,j.Z)("Crop",[["path",{d:"M6 2v14a2 2 0 0 0 2 2h14",key:"ron5a4"}],["path",{d:"M18 22V8a2 2 0 0 0-2-2H2",key:"7s9ehn"}]]),C=(0,j.Z)("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),T=(0,j.Z)("FileAudio",[["path",{d:"M17.5 22h.5a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"rslqgf"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 19a2 2 0 1 1 4 0v1a2 2 0 1 1-4 0v-4a6 6 0 0 1 12 0v4a2 2 0 1 1-4 0v-1a2 2 0 1 1 4 0",key:"9f7x3i"}]]);var E=s(74573),S=s(42911),A=s(51305),I=s(13894),M=s(48972);function O({valueMs:e,onChange:a}){let[s,l]=(0,r.useState)("minutes"),[i,n]=(0,r.useState)(0);(0,r.useEffect)(()=>{if(0===e){n(0);return}e%36e5==0?(l("hours"),n(e/36e5)):e%6e4==0?(l("minutes"),n(e/6e4)):(l("seconds"),n(Math.floor(e/1e3)))},[e]);let d=(e,s)=>{let t=0;"seconds"===s&&(t=1e3*e),"minutes"===s&&(t=6e4*e),"hours"===s&&(t=36e5*e),a(t),n(e),l(s)};return(0,t.jsxs)("div",{className:"flex items-center gap-1 bg-black/20 rounded border border-zinc-800/50 p-1",children:[t.jsx("span",{className:"text-[10px] text-zinc-500 pl-1",children:"Delay:"}),t.jsx(c.I,{type:"number",min:0,className:"w-12 h-6 text-xs px-1 py-0 bg-transparent border-none focus-visible:ring-0 text-right",value:i,onChange:e=>d(Number(e.target.value),s)}),(0,t.jsxs)(I.Ph,{value:s,onValueChange:e=>d(i,e),children:[t.jsx(I.i4,{className:"h-6 w-[70px] text-[10px] px-1 border-none bg-transparent focus:ring-0 gap-0",children:t.jsx(I.ki,{})}),(0,t.jsxs)(I.Bw,{children:[t.jsx(I.Ql,{value:"seconds",children:"Seg"}),t.jsx(I.Ql,{value:"minutes",children:"Min"}),t.jsx(I.Ql,{value:"hours",children:"Horas"})]})]})]})}function _({rule:e,mode:a}){let s=(0,l.useRouter)();(0,i.e)();let[j,_]=(0,r.useState)(!1),[R,P]=(0,r.useState)({}),[U,D]=(0,r.useState)(e?.name||""),[Z,L]=(0,r.useState)(e?.isActive??!0),[Q,B]=(0,r.useState)(e?.priority||0),[F,H]=(0,r.useState)(e?.cooldownSeconds||0),[G,q]=(0,r.useState)(e?.matchType||"CONTAINS"),[$,W]=(0,r.useState)(e?.matchOperator||"ANY"),[V,J]=(0,r.useState)(""),[Y,X]=(0,r.useState)(e?.keywords||[]),[K,ee]=(0,r.useState)(e?.triggerType||"MESSAGE_ANY"),[ea,es]=(0,r.useState)(e?.triggerConfig||{}),[et,er]=(0,r.useState)(e?.flow?.enabled||!1),[el,ei]=(0,r.useState)(e?.flow?.steps||[]),[en,ec]=(0,r.useState)([]),[ed,eo]=(0,r.useState)(e?.pageIds||[]),[ex,em]=(0,r.useState)([]),[ep,eh]=(0,r.useState)(!1),[eu,eb]=(0,r.useState)(!1),eg=async()=>{if(1!==ed.length){A.Am.error("Selecione exatamente UMA p\xe1gina para buscar posts.");return}eh(!0);try{let e=await fetch(`/api/messenger/pages/${ed[0]}/posts`),a=await e.json();if(a.error)throw Error(a.error);em(a.posts||[]),eb(!0)}catch(e){A.Am.error(e.message||"Erro ao buscar posts")}finally{eh(!1)}};(0,r.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/messenger/status");if(e.ok){let a=await e.json();ec(a.accounts||[])}}catch(e){console.error(e)}})()},[]);let[ef,ej]=(0,r.useState)(()=>(function(e){let a=[],s=e=>{let a="reply",s="";return"web_url"===e.type?(a="url",s=e.url||""):e.payload&&e.payload.startsWith("FLOW_JUMP::")?(a="flow_jump",s=e.payload.replace("FLOW_JUMP::","")):(a="reply",s=e.payload||e.title||""),{label:e.title||e.label||"Bot\xe3o",actionType:a,value:s}};for(let t=0;t<e.length;t++){let r=e[t];if("TEXT"===r.type){let l=e[t+1];if(l&&"BUTTON_TEMPLATE"===l.type&&(!l.delayMs||0===l.delayMs)){a.push({type:"MESSAGE_WITH_BUTTONS",delayMs:r.delayMs,payload:{message:r.payload.text,buttons:(l.payload.buttons||[]).map(s)}}),t++;continue}a.push({type:"MESSAGE_WITH_BUTTONS",delayMs:r.delayMs,payload:{message:r.payload.text,buttons:[]}});continue}if("BUTTON_TEMPLATE"===r.type){a.push({type:"MESSAGE_WITH_BUTTONS",delayMs:r.delayMs,payload:{message:r.payload.text,buttons:(r.payload.buttons||[]).map(s)}});continue}a.push(r)}return a})(e?.actions||[])),eN=()=>{V.trim()&&(X([...Y,V.trim()]),J(""))},ev=e=>{X(Y.filter((a,s)=>s!==e))},ey=e=>{ej([...ef,{type:e,delayMs:0,payload:ew(e)}]),A.Am.success(`A\xe7\xe3o ${ez(e)} adicionada`)},ew=e=>{switch(e){case"TEXT":return{text:""};case"MESSAGE_WITH_BUTTONS":return{message:"",buttons:[]};case"BUTTON_TEMPLATE":return{text:"",buttons:[]};case"GENERIC_TEMPLATE":return{title:"",subtitle:"",imageUrl:"",buttons:[],cardFormat:"SQUARE",cropMode:"NONE",derivedImageUrl:""};case"AUDIO":case"IMAGE":return{url:""};default:return{}}},ez=e=>{switch(e){case"TEXT":return"Texto (Antigo)";case"MESSAGE_WITH_BUTTONS":return"Mensagem";case"BUTTON_TEMPLATE":return"Bot\xf5es (Antigo)";case"GENERIC_TEMPLATE":return"Card (Img + Texto)";case"AUDIO":return"\xc1udio";case"IMAGE":return"Imagem";default:return e}},ek=e=>{ej(ef.filter((a,s)=>s!==e))},eC=(e,a,s)=>{let t=[...ef];if(a.startsWith("payload.")){let r=a.split(".")[1];t[e].payload={...t[e].payload,[r]:s}}else t[e][a]=s;ej(t)},[eT,eE]=(0,r.useState)({}),[eS,eA]=(0,r.useState)({}),eI=async(e,a,s)=>{try{let t=await fetch("/api/card-image/derive",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageUrl:e})});if(t.ok){let e=await t.json(),r=(0,E.NQ)(e.width,e.height,s);r.isMismatch?eE(e=>({...e,[a]:`Sua imagem est\xe1 em ${r.currentRatio}. ${r.recommendation}`})):eE(e=>({...e,[a]:null}))}}catch{}},eM=async(e,a,s)=>{eA(a=>({...a,[e]:!0}));try{let t=await fetch("/api/card-image/derive",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageUrl:a,cardFormat:s})});if(t.ok){let a=await t.json();eC(e,"payload.derivedImageUrl",a.derivedUrl),A.Am.success(`Imagem recortada (${E.JN[s].idealLabel}) com sucesso!`),eE(a=>({...a,[e]:null}))}else{let e=await t.json();A.Am.error("Erro ao recortar: "+(e.error||"Erro"))}}catch(e){A.Am.error("Erro ao recortar: "+e.message)}finally{eA(a=>({...a,[e]:!1}))}},eO=async(e,a,s="url")=>{let t=e.target.files?.[0];if(t){if(t.size>20971520){A.Am.error("Arquivo muito grande (M\xe1x 20MB)");return}P({...R,[a]:!0});try{let e=new FormData;e.append("file",t);let r=await fetch("/api/upload",{method:"POST",body:e}),l=await r.json();if(!r.ok)throw Error(l.error||"Erro no upload");let i=l.url;if(console.log("Upload success, public URL:",i),eC(a,`payload.${s}`,i),"imageUrl"===s){eC(a,"payload.derivedImageUrl","");let e=ef[a],s=e?.payload?.cardFormat||"SQUARE";eI(i,a,s)}A.Am.success("Arquivo enviado com sucesso!")}catch(e){console.error("Upload catch error:",e),A.Am.error("Erro no upload: "+(e.message||"Erro desconhecido"))}finally{P({...R,[a]:!1}),e.target.value=""}}},e_=e=>{let a=ef[e].payload.buttons||[];if(a.length>=3){A.Am.error("M\xe1ximo de 3 bot\xf5es permitidos");return}eC(e,"payload.buttons",[...a,{label:"Novo Bot\xe3o",actionType:"reply",value:""}])},eR=(e,a,s,t)=>{let r=[...ef[e].payload.buttons||[]];r[a]={...r[a],[s]:t},eC(e,"payload.buttons",r)},eP=(e,a)=>{let s=(ef[e].payload.buttons||[]).filter((e,s)=>s!==a);eC(e,"payload.buttons",s)},eU=async()=>{if(!U.trim()){A.Am.error("Nome da regra \xe9 obrigat\xf3rio");return}_(!0);let t={name:U,isActive:Z,priority:Number(Q),cooldownSeconds:Number(F),matchType:G,matchOperator:$,keywords:Y,pageIds:ed,triggerType:K,triggerConfig:ea,actions:et?[]:ef,flow:{enabled:et,steps:et?el:[]}};try{let r="create"===a?"/api/automations":`/api/automations/${e.id}`;if(!(await fetch(r,{method:"create"===a?"POST":"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw Error("Failed to save");A.Am.success("Regra salva com sucesso!"),s.push("/workflows"),s.refresh()}catch(e){console.error(e),A.Am.error("Erro ao salvar regra")}finally{_(!1)}};return(0,t.jsxs)("div",{className:"space-y-8 max-w-5xl mx-auto pb-32",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between sticky top-0 z-50 bg-background/80 backdrop-blur-lg py-4 border-b border-white/5 -mx-4 px-4 lg:-mx-8 lg:px-8",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[t.jsx(S.default,{href:"/workflows",children:t.jsx(n.z,{variant:"ghost",size:"icon",className:"hover:bg-zinc-800 rounded-full",children:t.jsx(p.Z,{className:"w-5 h-5"})})}),(0,t.jsxs)("div",{children:[t.jsx("h1",{className:"text-xl font-bold text-white flex items-center gap-2",children:"create"===a?"Criar Nova Regra":"Editar Regra"}),t.jsx("p",{className:"text-xs text-zinc-400",children:"Configure os gatilhos e respostas autom\xe1ticas"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-zinc-900 rounded-full border border-zinc-800",children:[t.jsx(d.r,{id:"active-mode",checked:Z,onCheckedChange:L}),t.jsx(x._,{htmlFor:"active-mode",className:"text-xs text-zinc-400 cursor-pointer",children:Z?"Ativo":"Pausado"})]}),(0,t.jsxs)(n.z,{onClick:eU,disabled:j,className:"bg-[#0084FF] hover:bg-[#0070D1] text-white rounded-full px-6 shadow-lg shadow-blue-500/20",children:[j?t.jsx(h.Z,{className:"w-4 h-4 mr-2 animate-spin"}):t.jsx(u.Z,{className:"w-4 h-4 mr-2"}),"Salvar Regra"]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,t.jsxs)("div",{className:"lg:col-span-1 space-y-6",children:[(0,t.jsxs)(o.Zb,{className:"bg-zinc-900/40 border-zinc-800/60 shadow-xl overflow-hidden",children:[t.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-500 to-cyan-500 opacity-20"}),(0,t.jsxs)(o.Ol,{children:[t.jsx(o.ll,{className:"text-sm font-medium text-zinc-200",children:"Gatilho (Quando responder?)"}),t.jsx(o.SZ,{children:"Defina quando esta automa\xe7\xe3o ser\xe1 disparada."})]}),(0,t.jsxs)(o.aY,{className:"space-y-5",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(x._,{className:"text-xs uppercase tracking-wider text-zinc-500",children:"Tipo de Evento"}),(0,t.jsxs)(I.Ph,{value:K,onValueChange:e=>{ee(e),"MESSAGE_OUTSIDE_24H"===e&&es(e=>({...e,thresholdHours:24,onlyIfReturning:!0})),"COMMENT_ON_POST"===e&&es(e=>({...e,ignoreOwnComments:!0}))},children:[t.jsx(I.i4,{className:"bg-black/40 border-zinc-800",children:t.jsx(I.ki,{})}),(0,t.jsxs)(I.Bw,{children:[t.jsx(I.Ql,{value:"MESSAGE_ANY",children:"Mensagem Recebida (DM)"}),t.jsx(I.Ql,{value:"MESSAGE_OUTSIDE_24H",children:"Reengajamento (Fora 24h)"}),t.jsx(I.Ql,{value:"COMMENT_ON_POST",children:"Coment\xe1rio em Post"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-4 pb-4 border-b border-white/5",children:[t.jsx(x._,{className:"text-xs uppercase tracking-wider text-zinc-500",children:"P\xe1ginas (Onde Executar)"}),j&&0===en.length?(0,t.jsxs)("div",{className:"text-xs text-zinc-500 flex items-center gap-2",children:[t.jsx(h.Z,{className:"w-3 h-3 animate-spin"})," Carregando p\xe1ginas..."]}):en.length>0?t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[150px] overflow-y-auto pr-1",children:en.map(e=>(0,t.jsxs)("div",{onClick:()=>{ed.includes(e.pageId)?eo(ed.filter(a=>a!==e.pageId)):eo([...ed,e.pageId])},className:`
                                                    cursor-pointer rounded-lg border p-3 flex items-center gap-3 transition-all
                                                    ${ed.includes(e.pageId)?"bg-blue-500/10 border-blue-500/50 hover:bg-blue-500/20":"bg-black/20 border-zinc-800 hover:border-zinc-700"}
                                                `,children:[t.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold ${ed.includes(e.pageId)?"bg-blue-600 text-white":"bg-zinc-800 text-zinc-400"}`,children:e.pageName.charAt(0)}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:`text-sm font-medium truncate ${ed.includes(e.pageId)?"text-blue-100":"text-zinc-300"}`,children:e.pageName}),(0,t.jsxs)("p",{className:"text-[10px] text-zinc-500 truncate",children:["ID: ",e.pageId]})]}),t.jsx("div",{className:`w-4 h-4 rounded-full border flex items-center justify-center ${ed.includes(e.pageId)?"bg-blue-500 border-blue-500":"border-zinc-600"}`,children:ed.includes(e.pageId)&&t.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})})]},e.id))}):t.jsx("div",{className:"text-xs text-yellow-500/80 bg-yellow-500/10 p-3 rounded border border-yellow-500/20",children:"Nenhuma p\xe1gina conectada. V\xe1 em Configura\xe7\xf5es > Integra\xe7\xf5es."}),(0,t.jsxs)("p",{className:"text-[10px] text-zinc-500",children:["Se nenhuma for selecionada, a regra ser\xe1 aplicada a ",t.jsx("strong",{children:"TODAS"})," as p\xe1ginas."]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(x._,{className:"text-xs uppercase tracking-wider text-zinc-500",children:"Nome da Regra"}),t.jsx(c.I,{value:U,onChange:e=>D(e.target.value),placeholder:"Ex: Resposta Pre\xe7os",className:"bg-black/40 border-zinc-800 focus:border-primary/50"})]}),"COMMENT_ON_POST"===K&&(0,t.jsxs)("div",{className:"space-y-4 pt-2 border-t border-white/5",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(x._,{className:"text-xs text-zinc-400",children:"Post IDs Espec\xedficos (Opcional)"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[t.jsx(c.I,{placeholder:"Digite ID do post e enter...",className:"bg-black/40 border-zinc-800",onKeyDown:e=>{if("Enter"===e.key){let a=e.currentTarget.value.trim();if(a){let s=ea.postIds||[];es({...ea,postIds:[...s,a]}),e.currentTarget.value=""}}}}),(0,t.jsxs)(M.Vq,{open:eu,onOpenChange:eb,children:[t.jsx(M.hg,{asChild:!0,children:t.jsx(n.z,{variant:"outline",className:"border-zinc-800 bg-zinc-900/50 hover:bg-zinc-800",onClick:e=>{e.preventDefault(),eg()},disabled:ep,children:ep?t.jsx(h.Z,{className:"w-4 h-4 animate-spin"}):"Listar Posts"})}),(0,t.jsxs)(M.cZ,{className:"max-w-2xl max-h-[80vh] overflow-hidden flex flex-col bg-zinc-950 border-zinc-800 text-white",children:[(0,t.jsxs)(M.fK,{children:[t.jsx(M.$N,{children:"Selecionar Posts Recentes"}),t.jsx(M.Be,{children:"Clique para adicionar/remover monitoramento."})]}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto p-1 space-y-2",children:[ex.map(e=>{let a=(ea.postIds||[]).some(a=>e.id.endsWith(a));return(0,t.jsxs)("div",{onClick:()=>{let s;let t=ea.postIds||[];s=a?t.filter(a=>!e.id.endsWith(a)):[...t,e.id],es({...ea,postIds:s})},className:`
                                                                        flex gap-4 p-3 rounded border transition-colors cursor-pointer
                                                                        ${a?"bg-blue-500/10 border-blue-500/50":"bg-zinc-900 border-zinc-800 hover:border-zinc-700"}
                                                                    `,children:[e.full_picture&&t.jsx("img",{src:e.full_picture,alt:"",className:"w-16 h-16 object-cover rounded"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-sm text-zinc-300 line-clamp-2",children:e.message||"[Sem legenda]"}),(0,t.jsxs)("p",{className:"text-xs text-zinc-500 mt-1",children:[new Date(e.created_time).toLocaleDateString()," • ID: ",e.id]})]}),a&&t.jsx("div",{className:"text-blue-500",children:t.jsx(b.Z,{className:"w-5 h-5 rotate-45"})})]},e.id)}),0===ex.length&&!ep&&t.jsx("div",{className:"p-4 text-center text-zinc-500",children:"Nenhum post recente encontrado."})]})]})]})]}),t.jsx("div",{className:"flex flex-wrap gap-2",children:(ea.postIds||[]).map((e,a)=>(0,t.jsxs)(m.C,{variant:"outline",className:"text-[10px] border-zinc-700",children:[e," ",t.jsx(g.Z,{className:"w-3 h-3 ml-1 cursor-pointer",onClick:()=>{let e=ea.postIds.filter((e,s)=>s!==a);es({...ea,postIds:e})}})]},a))}),t.jsx("p",{className:"text-[10px] text-zinc-500",children:"Deixe vazio para monitorar TODOS os posts."})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(d.r,{id:"ignore-own",checked:!1!==ea.ignoreOwnComments,onCheckedChange:e=>es({...ea,ignoreOwnComments:e})}),t.jsx(x._,{htmlFor:"ignore-own",className:"text-xs text-zinc-400",children:"Ignorar coment\xe1rios da pr\xf3pria p\xe1gina"})]})]}),"MESSAGE_OUTSIDE_24H"===K&&(0,t.jsxs)("div",{className:"space-y-4 pt-2 border-t border-white/5",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(x._,{className:"text-xs text-zinc-400",children:"Limite de Tempo (Horas)"}),t.jsx(c.I,{type:"number",value:ea.thresholdHours||24,onChange:e=>es({...ea,thresholdHours:Number(e.target.value)}),className:"bg-black/40 border-zinc-800"}),t.jsx("p",{className:"text-[10px] text-zinc-500",children:'Tempo sem intera\xe7\xe3o do usu\xe1rio para considerar "Fora da Janela".'})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(d.r,{id:"only-returning",checked:!1!==ea.onlyIfReturning,onCheckedChange:e=>es({...ea,onlyIfReturning:e})}),t.jsx(x._,{htmlFor:"only-returning",className:"text-xs text-zinc-400",children:"Apenas usu\xe1rios recorrentes (j\xe1 interagiram antes)"})]})]}),(0,t.jsxs)("div",{className:"space-y-2 pt-2 border-t border-white/5",children:[t.jsx(x._,{className:"text-xs uppercase tracking-wider text-zinc-500",children:"COMMENT_ON_POST"===K?"Palavras-chave no Coment\xe1rio":"Palavras-chave na Mensagem"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(I.Ph,{value:G,onValueChange:q,children:[t.jsx(I.i4,{className:"w-[130px] bg-black/40 border-zinc-800 text-xs",children:t.jsx(I.ki,{})}),(0,t.jsxs)(I.Bw,{children:[t.jsx(I.Ql,{value:"CONTAINS",children:"Cont\xe9m"}),t.jsx(I.Ql,{value:"EXACT",children:"Exato"}),t.jsx(I.Ql,{value:"STARTS_WITH",children:"Come\xe7a com"})]})]}),t.jsx(c.I,{value:V,onChange:e=>J(e.target.value),onKeyDown:e=>"Enter"===e.key&&eN(),placeholder:"Digite e enter...",className:"flex-1 bg-black/40 border-zinc-800 text-sm"})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 min-h-[40px] p-2 bg-black/20 rounded-md border border-zinc-800/50",children:[0===Y.length&&t.jsx("span",{className:"text-xs text-zinc-600 block w-full text-center py-2",children:"MESSAGE_OUTSIDE_24H"===K?"Qualquer mensagem (se vazio)":"Nenhuma palavra-chave"}),Y.map((e,a)=>(0,t.jsxs)(m.C,{variant:"secondary",className:"bg-blue-500/10 text-blue-400 border-blue-500/20 hover:bg-blue-500/20 gap-1 pl-2 pr-1 py-0.5",children:[e,t.jsx(g.Z,{className:"w-3 h-3 cursor-pointer hover:text-red-400",onClick:()=>ev(a)})]},a))]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(x._,{className:"text-xs text-zinc-500",children:"Prioridade"}),t.jsx(c.I,{type:"number",value:Q,onChange:e=>B(Number(e.target.value)),className:"bg-black/40 border-zinc-800"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(x._,{className:"text-xs text-zinc-500",children:"Cooldown (s)"}),t.jsx(c.I,{type:"number",value:F,onChange:e=>H(Number(e.target.value)),className:"bg-black/40 border-zinc-800"})]})]})]})]}),t.jsx("div",{className:"p-4 rounded-xl border border-dashed border-zinc-800/50 bg-zinc-900/20 text-center",children:t.jsx("p",{className:"text-xs text-zinc-500",children:"Dica: Use prioridade mais alta para regras espec\xedficas que devem sobrepor regras gen\xe9ricas."})})]}),(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("h2",{className:"text-lg font-medium text-white flex items-center gap-2",children:[t.jsx(f.Z,{className:"w-5 h-5 text-primary"}),"Resposta"]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 bg-zinc-900 px-3 py-1.5 rounded-full border border-zinc-800",children:[t.jsx("span",{className:`text-xs ${et?"text-zinc-500":"text-white font-medium"}`,children:"Simples"}),t.jsx(d.r,{checked:et,onCheckedChange:er}),t.jsx("span",{className:`text-xs ${et?"text-blue-400 font-medium":"text-zinc-500"}`,children:"Fluxo Conversacional"})]})]}),!et&&(0,t.jsxs)(m.C,{className:"bg-zinc-800 text-zinc-400 hover:bg-zinc-800",children:[ef.length," a\xe7\xf5es"]})]}),et?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg text-sm text-blue-200",children:[t.jsx("strong",{children:"Modo Conversacional:"})," Crie perguntas e direcione o usu\xe1rio com base nas respostas."]}),el.map((e,a)=>(0,t.jsxs)(o.Zb,{className:"bg-zinc-900/40 border-zinc-800",children:[(0,t.jsxs)(o.Ol,{className:"py-3 px-4 border-b border-white/5 flex flex-row items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(m.C,{variant:"outline",className:"bg-blue-500/10 border-blue-500/30 text-blue-400",children:e.id}),t.jsx(c.I,{className:"w-24 h-7 text-xs bg-black/20 border-zinc-700",value:e.id,onChange:e=>{let s=[...el];s[a].id=e.target.value,ei(s)}}),(0,t.jsxs)(I.Ph,{value:e.expectedType||"any",onValueChange:e=>{let s=[...el];s[a].expectedType=e,ei(s)},children:[t.jsx(I.i4,{className:"h-7 w-[110px] text-[10px] bg-black/40 border-zinc-700",children:t.jsx(I.ki,{})}),(0,t.jsxs)(I.Bw,{children:[t.jsx(I.Ql,{value:"any",children:"Qualquer"}),t.jsx(I.Ql,{value:"keyword",children:"Texto Exato"}),t.jsx(I.Ql,{value:"number",children:"N\xfamero"})]})]})]}),t.jsx(n.z,{variant:"ghost",size:"icon",className:"h-7 w-7 text-zinc-500 hover:text-red-400",onClick:()=>{ei(el.filter((e,s)=>s!==a))},children:t.jsx(g.Z,{className:"w-4 h-4"})})]}),(0,t.jsxs)(o.aY,{className:"p-4 space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(x._,{className:"text-xs text-zinc-400",children:"Pergunta / Mensagem"}),t.jsx("textarea",{className:"flex w-full rounded-md border border-zinc-700 bg-black/40 px-3 py-2 text-sm text-white focus-visible:ring-1 focus-visible:ring-primary min-h-[60px]",value:e.message,onChange:e=>{let s=[...el];s[a].message=e.target.value,ei(s)},placeholder:"Ex: Qual sua cor favorita?"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[t.jsx(x._,{className:"text-xs text-zinc-400",children:"Condi\xe7\xf5es (Se resposta for...)"}),t.jsx(n.z,{size:"sm",variant:"outline",className:"h-6 text-[10px]",onClick:()=>{let s=[...el];s[a].conditions=[...e.conditions||[],{match:"",nextStep:""}],ei(s)},children:"+ Condi\xe7\xe3o"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(e.conditions||[]).map((s,r)=>(0,t.jsxs)("div",{className:"grid grid-cols-12 gap-2 p-2 bg-black/20 rounded border border-zinc-800/50 items-center",children:[t.jsx("div",{className:"col-span-4",children:t.jsx(c.I,{placeholder:"Resposta exata",className:"h-7 text-xs bg-black/40 border-zinc-700",value:s.match,onChange:e=>{let s=[...el];s[a].conditions[r].match=e.target.value,ei(s)}})}),t.jsx("div",{className:"col-span-1 text-center text-zinc-500",children:"→"}),t.jsx("div",{className:"col-span-6",children:t.jsx(c.I,{placeholder:"ID Pr\xf3xima Etapa (Ex: step_2)",className:"h-7 text-xs bg-black/40 border-zinc-700",value:s.nextStep,onChange:e=>{let s=[...el];s[a].conditions[r].nextStep=e.target.value,ei(s)}})}),t.jsx("div",{className:"col-span-1 flex justify-end",children:t.jsx(g.Z,{className:"w-3.5 h-3.5 text-zinc-600 cursor-pointer hover:text-red-400",onClick:()=>{let s=[...el];s[a].conditions=e.conditions.filter((e,a)=>a!==r),ei(s)}})})]},r)),0===(e.conditions||[]).length&&t.jsx("div",{className:"text-[10px] text-zinc-500 text-center py-2 border border-dashed border-zinc-800 rounded",children:"Sem condi\xe7\xf5es. O fluxo para aqui ou usa Fallback."})]})]}),(0,t.jsxs)("div",{className:"space-y-2 pt-2 border-t border-white/5",children:[t.jsx(x._,{className:"text-xs text-zinc-400",children:"Fallback (Se n\xe3o bater nenhuma condi\xe7\xe3o)"}),t.jsx(c.I,{className:"h-8 text-xs bg-black/40 border-zinc-700",placeholder:"Ex: N\xe3o entendi, fale 1 ou 2.",value:e.fallback?.message||"",onChange:e=>{let s=[...el];s[a].fallback={message:e.target.value},ei(s)}})]})]})]},a)),(0,t.jsxs)(n.z,{variant:"outline",className:"w-full border-dashed border-zinc-700 hover:border-blue-500 hover:bg-blue-500/5 text-zinc-400",onClick:()=>{let e=`step_${el.length+1}`;ei([...el,{id:e,type:"question",message:"",conditions:[]}])},children:[t.jsx(b.Z,{className:"w-4 h-4 mr-2"})," Adicionar Etapa"]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"space-y-4 min-h-[200px]",children:[0===ef.length&&(0,t.jsxs)("div",{className:"h-64 rounded-xl border border-dashed border-zinc-800 flex flex-col items-center justify-center text-zinc-500 gap-4 bg-zinc-900/20",children:[t.jsx(f.Z,{className:"w-10 h-10 opacity-20"}),t.jsx("p",{children:"Nenhuma a\xe7\xe3o definida."}),t.jsx("p",{className:"text-sm",children:"Selecione uma a\xe7\xe3o abaixo para come\xe7ar."})]}),ef.map((e,a)=>(0,t.jsxs)("div",{className:"group relative pl-4 border-l-2 border-zinc-800 hover:border-primary/50 transition-colors",children:[t.jsx("div",{className:"absolute -left-[5px] top-6 w-2 h-2 rounded-full bg-zinc-800 group-hover:bg-primary transition-colors ring-4 ring-background"}),(0,t.jsxs)(o.Zb,{className:"bg-zinc-950/50 border-zinc-800/80 group-hover:border-zinc-700 transition-colors",children:[(0,t.jsxs)(o.Ol,{className:"py-3 px-4 bg-white/5 border-b border-white/5 flex flex-row items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(m.C,{variant:"outline",className:"bg-black/40 border-zinc-700 font-mono text-[10px] uppercase tracking-wider text-zinc-400",children:ez(e.type)}),(0,t.jsxs)("span",{className:"text-xs text-zinc-500",children:["A\xe7\xe3o #",a+1]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(O,{valueMs:e.delayMs||0,onChange:e=>eC(a,"delayMs",e)}),t.jsx(n.z,{variant:"ghost",size:"icon",className:"h-7 w-7 text-zinc-500 hover:text-red-400 hover:bg-red-500/10 rounded-md",onClick:()=>ek(a),children:t.jsx(g.Z,{className:"w-3.5 h-3.5"})})]})]}),(0,t.jsxs)(o.aY,{className:"p-4",children:[("MESSAGE_WITH_BUTTONS"===e.type||"TEXT"===e.type||"BUTTON_TEMPLATE"===e.type)&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(x._,{className:"text-xs text-zinc-400",children:"Mensagem"}),t.jsx("textarea",{className:"flex w-full rounded-md border border-zinc-700 bg-black/40 px-3 py-2 text-sm text-white placeholder:text-zinc-600 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-primary min-h-[80px]",value:e.payload.message||e.payload.text||"",onChange:e=>eC(a,"payload.message",e.target.value),placeholder:"Digite sua mensagem aqui..."})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[t.jsx(x._,{className:"text-xs text-zinc-400",children:"Bot\xf5es (Opcional - Max 3)"}),(0,t.jsxs)(n.z,{variant:"outline",size:"sm",className:"h-6 text-[10px]",onClick:()=>e_(a),disabled:(e.payload.buttons?.length||0)>=3,children:[t.jsx(b.Z,{className:"w-3 h-3 mr-1"})," Add Bot\xe3o"]})]}),t.jsx("div",{className:"space-y-2",children:(e.payload.buttons||[]).map((e,s)=>(0,t.jsxs)("div",{className:"grid grid-cols-12 gap-2 bg-black/20 p-2 rounded border border-zinc-800 items-start",children:[t.jsx("div",{className:"col-span-3",children:(0,t.jsxs)(I.Ph,{value:e.actionType||"reply",onValueChange:e=>eR(a,s,"actionType",e),children:[t.jsx(I.i4,{className:"h-7 text-[10px] bg-black/40 border-zinc-700",children:t.jsx(I.ki,{})}),(0,t.jsxs)(I.Bw,{children:[t.jsx(I.Ql,{value:"reply",children:"Responder"}),t.jsx(I.Ql,{value:"url",children:"Abrir Link"}),t.jsx(I.Ql,{value:"flow_jump",children:"Ir p/ Fluxo"})]})]})}),t.jsx("div",{className:"col-span-4",children:t.jsx(c.I,{className:"h-7 text-[10px] bg-black/40 border-zinc-700",placeholder:"Label do Bot\xe3o",value:e.label||e.title||"",onChange:e=>eR(a,s,"label",e.target.value)})}),t.jsx("div",{className:"col-span-4",children:t.jsx(c.I,{className:"h-7 text-[10px] bg-black/40 border-zinc-700",placeholder:"url"===e.actionType?"https://...":"flow_jump"===e.actionType?"ID do Fluxo":"Mensagem/Payload",value:e.value||e.url||e.payload||"",onChange:e=>eR(a,s,"value",e.target.value)})}),t.jsx("div",{className:"col-span-1 flex justify-end",children:t.jsx(n.z,{variant:"ghost",size:"icon",className:"h-7 w-7 text-zinc-500 hover:text-red-400",onClick:()=>eP(a,s),children:t.jsx(g.Z,{className:"w-3 h-3"})})})]},s))})]})]}),"AUDIO"===e.type&&(0,t.jsxs)("div",{className:"space-y-4",children:[t.jsx(x._,{className:"text-xs text-zinc-400",children:"Arquivo de \xc1udio"}),(0,t.jsxs)("div",{className:"flex flex-col gap-3",children:[t.jsx("div",{className:"flex items-center gap-2",children:t.jsx(c.I,{disabled:!0,value:e.payload.url||"",placeholder:"URL do a\xfadio...",className:"bg-black/40 border-zinc-800 opacity-70"})}),t.jsx("div",{className:"flex items-center gap-2",children:(0,t.jsxs)("label",{className:"flex-1 cursor-pointer",children:[(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2 w-full h-10 rounded-md border border-dashed border-zinc-700 hover:border-primary/50 hover:bg-primary/5 transition-all text-sm text-zinc-400 hover:text-primary",children:[R[a]?t.jsx(h.Z,{className:"w-4 h-4 animate-spin"}):t.jsx(N,{className:"w-4 h-4"}),R[a]?"Enviando...":"Carregar do Dispositivo (MP3, OGG, WAV)"]}),t.jsx("input",{type:"file",accept:"audio/*",className:"hidden",onChange:e=>eO(e,a)})]})}),e.payload.url&&t.jsx("audio",{controls:!0,src:e.payload.url,className:"w-full mt-2 h-8"})]})]}),"IMAGE"===e.type&&(0,t.jsxs)("div",{className:"space-y-4",children:[t.jsx(x._,{className:"text-xs text-zinc-400",children:"Imagem Avulsa"}),t.jsx("div",{className:"flex flex-col gap-3",children:t.jsx("label",{className:"flex-1 cursor-pointer",children:(0,t.jsxs)("div",{className:"relative group overflow-hidden rounded-lg border-2 border-dashed border-zinc-700 hover:border-primary/50 transition-all bg-black/20 aspect-video flex flex-col items-center justify-center",children:[e.payload.url?t.jsx("img",{src:e.payload.url,alt:"Preview",className:"w-full h-full object-contain"}):(0,t.jsxs)(t.Fragment,{children:[R[a]?t.jsx(h.Z,{className:"w-8 h-8 animate-spin text-zinc-500"}):t.jsx(v,{className:"w-8 h-8 text-zinc-500 mb-2 group-hover:text-primary"}),t.jsx("span",{className:"text-sm text-zinc-400 group-hover:text-primary",children:"Clique para enviar imagem"})]}),t.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 hover:opacity-100 transition-opacity flex items-center justify-center",children:t.jsx(N,{className:"w-6 h-6 text-white"})}),t.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>eO(e,a,"imageUrl")})]})})})]}),"GENERIC_TEMPLATE"===e.type&&(()=>{let s=e.payload.cardFormat||"SQUARE",r=E.JN[s]||E.JN.SQUARE;return(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-black/20 border border-zinc-800/50",children:[t.jsx(y,{className:"w-4 h-4 text-zinc-400 shrink-0"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[t.jsx(x._,{className:"text-xs text-zinc-300 font-medium",children:"Formato do Card (preview)"}),(0,t.jsxs)("p",{className:"text-[10px] text-zinc-500 mt-0.5",children:["Tamanho ideal: ",r.idealLabel]})]}),(0,t.jsxs)(I.Ph,{value:s,onValueChange:s=>{eC(a,"payload.cardFormat",s),eC(a,"payload.derivedImageUrl",""),e.payload.imageUrl&&eI(e.payload.imageUrl,a,s)},children:[t.jsx(I.i4,{className:"w-[200px] h-8 text-xs bg-black/40 border-zinc-700",children:t.jsx(I.ki,{})}),(0,t.jsxs)(I.Bw,{children:[t.jsx(I.Ql,{value:"SQUARE",children:"Quadrado (1:1)"}),t.jsx(I.Ql,{value:"PORTRAIT",children:"Retrato (4:5)"}),t.jsx(I.Ql,{value:"LANDSCAPE",children:"Paisagem (1.91:1)"})]})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-2 px-3 py-2 rounded bg-blue-500/10 border border-blue-500/20",children:[t.jsx(w,{className:"w-3.5 h-3.5 text-blue-400 mt-0.5 shrink-0"}),t.jsx("p",{className:"text-[10px] text-blue-300/80 leading-relaxed",children:"PORTRAIT"===s?"Retrato: a imagem ser\xe1 colocada dentro de um quadrado com fundo branco, aparecendo COMPLETA no Messenger (sem cortes).":`O Messenger exibir\xe1 o card em formato ${"LANDSCAPE"===s?"paisagem (1.91:1)":"quadrado (1:1)"}. Ative o recorte para garantir que a imagem se encaixe perfeitamente.`})]}),eT[a]&&(0,t.jsxs)("div",{className:"flex items-start gap-2 px-3 py-2 rounded bg-amber-500/10 border border-amber-500/20",children:[t.jsx(z,{className:"w-3.5 h-3.5 text-amber-400 mt-0.5 shrink-0"}),t.jsx("p",{className:"text-[10px] text-amber-300/80",children:eT[a]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-black/20 border border-zinc-800/50",children:[t.jsx(k,{className:"w-4 h-4 text-zinc-400 shrink-0"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[t.jsx(x._,{className:"text-xs text-zinc-300 font-medium",children:"PORTRAIT"===s?"Ajuste Autom\xe1tico":"Recorte Autom\xe1tico"}),t.jsx("p",{className:"text-[10px] text-zinc-500 mt-0.5",children:"PORTRAIT"===s?"Encaixa a imagem inteira em um quadrado com fundo branco — sem cortes":`Recorta a imagem para ${r.idealLabel} antes de enviar`})]}),t.jsx(d.r,{checked:"AUTO_CENTER_CROP"===e.payload.cropMode,onCheckedChange:e=>{eC(a,"payload.cropMode",e?"AUTO_CENTER_CROP":"NONE"),e||eC(a,"payload.derivedImageUrl","")}})]}),"AUTO_CENTER_CROP"===e.payload.cropMode&&e.payload.imageUrl&&!e.payload.derivedImageUrl&&t.jsx(n.z,{variant:"outline",size:"sm",className:"w-full h-8 text-xs border-emerald-500/30 text-emerald-400 hover:bg-emerald-500/10",onClick:()=>eM(a,e.payload.imageUrl,s),disabled:eS[a],children:eS[a]?(0,t.jsxs)(t.Fragment,{children:[t.jsx(h.Z,{className:"w-3 h-3 mr-2 animate-spin"})," Recortando..."]}):(0,t.jsxs)(t.Fragment,{children:[t.jsx(k,{className:"w-3 h-3 mr-2"})," Gerar Imagem Recortada (",r.idealLabel,")"]})}),e.payload.derivedImageUrl&&(0,t.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 rounded bg-emerald-500/10 border border-emerald-500/20",children:[t.jsx(C,{className:"w-3.5 h-3.5 text-emerald-400 shrink-0"}),(0,t.jsxs)("p",{className:"text-[10px] text-emerald-300/80 flex-1",children:["Imagem recortada salva (",r.idealLabel,"). Ser\xe1 usada ao enviar."]}),t.jsx(n.z,{variant:"ghost",size:"sm",className:"h-5 text-[9px] text-zinc-400 hover:text-red-400 px-2",onClick:()=>eC(a,"payload.derivedImageUrl",""),children:"Remover"})]}),(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,t.jsxs)("div",{className:"w-full md:w-1/3 shrink-0",children:[t.jsx("label",{className:"cursor-pointer block",children:(0,t.jsxs)("div",{className:"rounded-lg border-2 border-dashed border-zinc-700 hover:border-primary/50 transition-all bg-black/20 flex flex-col items-center justify-center overflow-hidden relative",style:{aspectRatio:r.cssAspectRatio},children:[e.payload.imageUrl?t.jsx("img",{src:e.payload.derivedImageUrl||e.payload.imageUrl,alt:"Card Cover",className:"absolute inset-0 w-full h-full object-cover",style:{objectPosition:"center"}}):(0,t.jsxs)("div",{className:"text-center p-4",children:[R[a]?t.jsx(h.Z,{className:"w-6 h-6 animate-spin mx-auto mb-2 text-zinc-500"}):t.jsx(v,{className:"w-6 h-6 mx-auto mb-2 text-zinc-500"}),t.jsx("span",{className:"text-[10px] text-zinc-400 block",children:"Capa do Card"}),t.jsx("span",{className:"text-[9px] text-zinc-500 block mt-1",children:r.label})]}),t.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 hover:opacity-100 transition-opacity flex items-center justify-center",children:t.jsx(N,{className:"w-6 h-6 text-white"})}),t.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>eO(e,a,"imageUrl")})]})}),t.jsx("p",{className:"text-[9px] text-zinc-600 mt-1 text-center",children:"Safe area: margem interna 8-12% do tamanho"})]}),(0,t.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[t.jsx(x._,{className:"text-xs text-zinc-400",children:"T\xedtulo"}),t.jsx(c.I,{className:"h-8 bg-black/40 border-zinc-800",value:e.payload.title||"",onChange:e=>eC(a,"payload.title",e.target.value),placeholder:"T\xedtulo do Produto/Card"})]}),(0,t.jsxs)("div",{className:"space-y-1",children:[t.jsx(x._,{className:"text-xs text-zinc-400",children:"Subt\xedtulo"}),t.jsx(c.I,{className:"h-8 bg-black/40 border-zinc-800",value:e.payload.subtitle||"",onChange:e=>eC(a,"payload.subtitle",e.target.value),placeholder:"Breve descri\xe7\xe3o..."})]}),(0,t.jsxs)("div",{className:"space-y-2 pt-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[t.jsx(x._,{className:"text-xs text-zinc-400",children:"Bot\xf5es (Max 3)"}),(0,t.jsxs)(n.z,{variant:"outline",size:"sm",className:"h-6 text-[10px]",onClick:()=>e_(a),disabled:(e.payload.buttons?.length||0)>=3,children:[t.jsx(b.Z,{className:"w-3 h-3 mr-1"})," Add"]})]}),t.jsx("div",{className:"space-y-2",children:(e.payload.buttons||[]).map((e,s)=>(0,t.jsxs)("div",{className:"grid grid-cols-12 gap-2 bg-black/20 p-2 rounded border border-zinc-800 items-center",children:[t.jsx("div",{className:"col-span-3",children:(0,t.jsxs)(I.Ph,{value:e.type,onValueChange:e=>eR(a,s,"type",e),children:[t.jsx(I.i4,{className:"h-7 text-[10px] bg-black/40 border-zinc-700",children:t.jsx(I.ki,{})}),(0,t.jsxs)(I.Bw,{children:[t.jsx(I.Ql,{value:"web_url",children:"Link"}),t.jsx(I.Ql,{value:"postback",children:"Postback"})]})]})}),t.jsx("div",{className:"col-span-4",children:t.jsx(c.I,{className:"h-7 text-[10px] bg-black/40 border-zinc-700",placeholder:"T\xedtulo",value:e.title,onChange:e=>eR(a,s,"title",e.target.value)})}),t.jsx("div",{className:"col-span-4",children:t.jsx(c.I,{className:"h-7 text-[10px] bg-black/40 border-zinc-700",placeholder:"web_url"===e.type?"URL":"Payload",value:"web_url"===e.type?e.url:e.payload,onChange:t=>eR(a,s,"web_url"===e.type?"url":"payload",t.target.value)})}),t.jsx("div",{className:"col-span-1 flex justify-end",children:t.jsx(n.z,{variant:"ghost",size:"icon",className:"h-7 w-7 text-zinc-500 hover:text-red-400",onClick:()=>eP(a,s),children:t.jsx(g.Z,{className:"w-3 h-3"})})})]},s))})]})]})]})]})})()]})]})]},a))]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3 pt-4 border-t border-zinc-800",children:[(0,t.jsxs)(n.z,{variant:"outline",className:"h-auto py-3 flex flex-col gap-2 hover:bg-zinc-800 border-zinc-800",onClick:()=>ey("MESSAGE_WITH_BUTTONS"),children:[t.jsx(f.Z,{className:"w-5 h-5 text-zinc-400 group-hover:text-primary"}),t.jsx("span",{className:"text-xs",children:"Mensagem"})]}),(0,t.jsxs)(n.z,{variant:"outline",className:"h-auto py-3 flex flex-col gap-2 hover:bg-zinc-800 border-zinc-800",onClick:()=>ey("GENERIC_TEMPLATE"),children:[(0,t.jsxs)("div",{className:"relative",children:[t.jsx(v,{className:"w-5 h-5 text-zinc-400"}),t.jsx(m.C,{className:"absolute -top-2 -right-3 text-[8px] h-3 px-1",children:"Novo"})]}),t.jsx("span",{className:"text-xs",children:"Card Image"})]}),(0,t.jsxs)(n.z,{variant:"outline",className:"h-auto py-3 flex flex-col gap-2 hover:bg-zinc-800 border-zinc-800",onClick:()=>ey("IMAGE"),children:[t.jsx(v,{className:"w-5 h-5 text-zinc-400 group-hover:text-primary"}),t.jsx("span",{className:"text-xs",children:"Img Avulsa"})]}),(0,t.jsxs)(n.z,{variant:"outline",className:"h-auto py-3 flex flex-col gap-2 hover:bg-zinc-800 border-zinc-800",onClick:()=>ey("AUDIO"),children:[t.jsx(T,{className:"w-5 h-5 text-zinc-400 group-hover:text-primary"}),t.jsx("span",{className:"text-xs",children:"\xc1udio"})]})]})]})]})]})]})}},32538:(e,a,s)=>{"use strict";s.d(a,{C:()=>n});var t=s(44297);s(65803);var r=s(65723),l=s(67952);let i=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-500 text-white hover:bg-green-600"}},defaultVariants:{variant:"default"}});function n({className:e,variant:a,...s}){return t.jsx("div",{className:(0,l.cn)(i({variant:a}),e),...s})}},81584:(e,a,s)=>{"use strict";s.d(a,{Ol:()=>n,SZ:()=>d,Zb:()=>i,aY:()=>o,eW:()=>x,ll:()=>c});var t=s(44297),r=s(65803),l=s(67952);let i=r.forwardRef(({className:e,...a},s)=>t.jsx("div",{ref:s,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...a}));i.displayName="Card";let n=r.forwardRef(({className:e,...a},s)=>t.jsx("div",{ref:s,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",e),...a}));n.displayName="CardHeader";let c=r.forwardRef(({className:e,...a},s)=>t.jsx("h3",{ref:s,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",e),...a}));c.displayName="CardTitle";let d=r.forwardRef(({className:e,...a},s)=>t.jsx("p",{ref:s,className:(0,l.cn)("text-sm text-muted-foreground",e),...a}));d.displayName="CardDescription";let o=r.forwardRef(({className:e,...a},s)=>t.jsx("div",{ref:s,className:(0,l.cn)("p-6 pt-0",e),...a}));o.displayName="CardContent";let x=r.forwardRef(({className:e,...a},s)=>t.jsx("div",{ref:s,className:(0,l.cn)("flex items-center p-6 pt-0",e),...a}));x.displayName="CardFooter"},48972:(e,a,s)=>{"use strict";s.d(a,{$N:()=>u,Be:()=>b,Vq:()=>c,cN:()=>h,cZ:()=>m,fK:()=>p,hg:()=>d});var t=s(44297),r=s(65803),l=s(61687),i=s(4721),n=s(67952);let c=l.fC,d=l.xz,o=l.h_;l.x8;let x=r.forwardRef(({className:e,...a},s)=>t.jsx(l.aV,{ref:s,className:(0,n.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...a}));x.displayName=l.aV.displayName;let m=r.forwardRef(({className:e,children:a,...s},r)=>(0,t.jsxs)(o,{children:[t.jsx(x,{}),(0,t.jsxs)(l.VY,{ref:r,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...s,children:[a,(0,t.jsxs)(l.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[t.jsx(i.Z,{className:"h-4 w-4"}),t.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));m.displayName=l.VY.displayName;let p=({className:e,...a})=>t.jsx("div",{className:(0,n.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...a});p.displayName="DialogHeader";let h=({className:e,...a})=>t.jsx("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...a});h.displayName="DialogFooter";let u=r.forwardRef(({className:e,...a},s)=>t.jsx(l.Dx,{ref:s,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",e),...a}));u.displayName=l.Dx.displayName;let b=r.forwardRef(({className:e,...a},s)=>t.jsx(l.dk,{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",e),...a}));b.displayName=l.dk.displayName},82984:(e,a,s)=>{"use strict";s.d(a,{I:()=>i});var t=s(44297),r=s(65803),l=s(67952);let i=r.forwardRef(({className:e,type:a,...s},r)=>t.jsx("input",{type:a,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...s}));i.displayName="Input"},90096:(e,a,s)=>{"use strict";s.d(a,{_:()=>o});var t=s(44297),r=s(65803),l=s(82455),i=r.forwardRef((e,a)=>(0,t.jsx)(l.WV.label,{...e,ref:a,onMouseDown:a=>{a.target.closest("button, input, select, textarea")||(e.onMouseDown?.(a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));i.displayName="Label";var n=s(65723),c=s(67952);let d=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=r.forwardRef(({className:e,...a},s)=>t.jsx(i,{ref:s,className:(0,c.cn)(d(),e),...a}));o.displayName=i.displayName},80541:(e,a,s)=>{"use strict";s.d(a,{r:()=>w});var t=s(44297),r=s(65803),l=s(44152),i=s(23423),n=s(91740),c=s(56283),d=s(11225),o=s(98326),x=s(81774),m="Switch",[p,h]=(0,n.b)(m),[u,b]=p(m),g=r.forwardRef((e,a)=>{let{__scopeSwitch:s,name:n,checked:d,defaultChecked:o,required:p,disabled:h,value:b="on",onCheckedChange:g,form:f,...j}=e,[y,w]=r.useState(null),z=(0,i.e)(a,e=>w(e)),k=r.useRef(!1),C=!y||f||!!y.closest("form"),[T,E]=(0,c.T)({prop:d,defaultProp:o??!1,onChange:g,caller:m});return(0,t.jsxs)(u,{scope:s,checked:T,disabled:h,children:[(0,t.jsx)(x.WV.button,{type:"button",role:"switch","aria-checked":T,"aria-required":p,"data-state":v(T),"data-disabled":h?"":void 0,disabled:h,value:b,...j,ref:z,onClick:(0,l.Mj)(e.onClick,e=>{E(e=>!e),C&&(k.current=e.isPropagationStopped(),k.current||e.stopPropagation())})}),C&&(0,t.jsx)(N,{control:y,bubbles:!k.current,name:n,value:b,checked:T,required:p,disabled:h,form:f,style:{transform:"translateX(-100%)"}})]})});g.displayName=m;var f="SwitchThumb",j=r.forwardRef((e,a)=>{let{__scopeSwitch:s,...r}=e,l=b(f,s);return(0,t.jsx)(x.WV.span,{"data-state":v(l.checked),"data-disabled":l.disabled?"":void 0,...r,ref:a})});j.displayName=f;var N=r.forwardRef(({__scopeSwitch:e,control:a,checked:s,bubbles:l=!0,...n},c)=>{let x=r.useRef(null),m=(0,i.e)(x,c),p=(0,d.D)(s),h=(0,o.t)(a);return r.useEffect(()=>{let e=x.current;if(!e)return;let a=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(p!==s&&a){let t=new Event("click",{bubbles:l});a.call(e,s),e.dispatchEvent(t)}},[p,s,l]),(0,t.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s,...n,tabIndex:-1,ref:m,style:{...n.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function v(e){return e?"checked":"unchecked"}N.displayName="SwitchBubbleInput";var y=s(67952);let w=r.forwardRef(({className:e,...a},s)=>t.jsx(g,{className:(0,y.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...a,ref:s,children:t.jsx(j,{className:(0,y.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));w.displayName=g.displayName},74573:(e,a,s)=>{"use strict";s.d(a,{JN:()=>t,NQ:()=>r});let t={SQUARE:{label:"Quadrado (1:1)",ratio:1,cssAspectRatio:"1 / 1",idealWidth:1080,idealHeight:1080,idealLabel:"1080\xd71080",messengerRatio:"square",deriveStrategy:"crop"},PORTRAIT:{label:"Retrato (4:5)",ratio:.8,cssAspectRatio:"4 / 5",idealWidth:1080,idealHeight:1350,idealLabel:"1080\xd71350",messengerRatio:"square",deriveStrategy:"fit"},LANDSCAPE:{label:"Paisagem (1.91:1)",ratio:1.91,cssAspectRatio:"1.91 / 1",idealWidth:1200,idealHeight:628,idealLabel:"1200\xd7628",messengerRatio:"horizontal",deriveStrategy:"crop"}};function r(e,a,s,r=.15){let l=0===a?1:e/a,i=t[s]||t.SQUARE;return{isMismatch:Math.abs(l-i.ratio)/i.ratio>r,currentRatio:`${l>1.5?"Paisagem":l<.85?"Retrato":"Quadrado"} (~${l.toFixed(2)}:1)`,recommendation:`Para melhor resultado em ${i.label}, use ${i.idealLabel}.`}}},84811:(e,a,s)=>{"use strict";s.d(a,{Z:()=>t});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,s(55079).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},42682:(e,a,s)=>{"use strict";s.d(a,{Z:()=>t});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,s(55079).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},62529:(e,a,s)=>{"use strict";s.d(a,{s:()=>n});var t=s(37460);let r=(0,t.createProxy)(String.raw`C:\Users\jeang\OneDrive\Desktop\adnext\apps\web\src\app\(dashboard)\workflows\_components\rule-editor.tsx`),{__esModule:l,$$typeof:i}=r;r.default;let n=(0,t.createProxy)(String.raw`C:\Users\jeang\OneDrive\Desktop\adnext\apps\web\src\app\(dashboard)\workflows\_components\rule-editor.tsx#RuleEditor`)},73751:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>l});var t=s(71002),r=s(20949);function l(){return(0,t.jsxs)("div",{className:"space-y-6 animate-in fade-in duration-300",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(r.O,{className:"h-8 w-36 bg-zinc-800"}),t.jsx(r.O,{className:"h-4 w-80 bg-zinc-800/60"})]}),t.jsx(r.O,{className:"h-10 w-32 bg-zinc-800 rounded-md"})]}),(0,t.jsxs)("div",{className:"border border-white/10 rounded-lg bg-zinc-950/50 overflow-hidden",children:[t.jsx("div",{className:"bg-zinc-900/50 border-b border-white/5 px-6 py-4 flex gap-8",children:["w-20","w-32","w-16","w-12","w-16","w-16"].map((e,a)=>t.jsx(r.O,{className:`h-4 ${e} bg-zinc-800`},a))}),Array.from({length:4}).map((e,a)=>(0,t.jsxs)("div",{className:"px-6 py-4 flex items-center gap-8 border-b border-white/5 last:border-0",children:[t.jsx(r.O,{className:"h-4 w-28 bg-zinc-800"}),(0,t.jsxs)("div",{className:"flex gap-1.5",children:[t.jsx(r.O,{className:"h-5 w-14 rounded-full bg-zinc-800"}),t.jsx(r.O,{className:"h-5 w-18 rounded-full bg-zinc-800"})]}),t.jsx(r.O,{className:"h-4 w-8 bg-zinc-800"}),t.jsx(r.O,{className:"h-4 w-16 bg-zinc-800"}),t.jsx(r.O,{className:"h-5 w-14 rounded-full bg-zinc-800"}),(0,t.jsxs)("div",{className:"ml-auto flex gap-2",children:[t.jsx(r.O,{className:"h-8 w-8 rounded bg-zinc-800"}),t.jsx(r.O,{className:"h-8 w-8 rounded bg-zinc-800"})]})]},a))]})]})}},20949:(e,a,s)=>{"use strict";s.d(a,{O:()=>l});var t=s(71002),r=s(45482);function l({className:e,...a}){return t.jsx("div",{className:(0,r.cn)("animate-pulse rounded-md bg-zinc-800/50",e),...a})}},45482:(e,a,s)=>{"use strict";s.d(a,{cn:()=>l});var t=s(76031),r=s(80817);function l(...e){return(0,r.m6)((0,t.W)(e))}}};